"use strict";(self.webpackChunkstrapi_docs=self.webpackChunkstrapi_docs||[]).push([[7235],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>m});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=a.createContext({}),l=function(e){var t=a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},d=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=l(r),m=n,k=p["".concat(c,".").concat(m)]||p[m]||u[m]||o;return r?a.createElement(k,i(i({ref:t},d),{},{components:r})):a.createElement(k,i({ref:t},d))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var l=2;l<o;l++)i[l]=r[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}p.displayName="MDXCreateElement"},67327:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=r(83117),n=(r(67294),r(3905));const o={title:"Back-end customization",description:"All elements of Strapi's back end, like routes, policies, middlewares, controllers, services, models, requests, responses, and webhooks, can be customized."},i="Back-end customization",s={unversionedId:"dev-docs/backend-customization",id:"dev-docs/backend-customization",title:"Back-end customization",description:"All elements of Strapi's back end, like routes, policies, middlewares, controllers, services, models, requests, responses, and webhooks, can be customized.",source:"@site/docs/dev-docs/backend-customization.md",sourceDirName:"dev-docs",slug:"/dev-docs/backend-customization",permalink:"/dev-docs/backend-customization",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/dev-docs/backend-customization.md",tags:[],version:"current",frontMatter:{title:"Back-end customization",description:"All elements of Strapi's back end, like routes, policies, middlewares, controllers, services, models, requests, responses, and webhooks, can be customized."}},c={},l=[{value:"Interactive diagram",id:"interactive-diagram",level:2}],d={toc:l};function u(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"back-end-customization"},"Back-end customization"),(0,n.kt)("p",null,':::strapi Disambiguation: Strapi back end\nAs a headless CMS, the Strapi software as a whole can be considered as the "back end" of your website or application.\nBut the Strapi software itself includes 2 different parts:'),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"The ",(0,n.kt)("strong",{parentName:"li"},"back-end")," part of Strapi is an HTTP server that Strapi runs. Like any HTTP server, the Strapi back end receives requests and send responses. Your content is stored in a database, and the Strapi back end interacts with the database to create, retrieve, update, and delete content."),(0,n.kt)("li",{parentName:"ul"},"The ",(0,n.kt)("strong",{parentName:"li"},"front-end")," part of Strapi is called the admin panel. The admin panel presents a graphical user interface to help you structure and manage the content.")),(0,n.kt)("p",null,"Throughout this developer documentation, 'back end' refers ",(0,n.kt)("em",{parentName:"p"},"exclusively")," to the back-end part of Strapi."),(0,n.kt)("p",null,"The ",(0,n.kt)("a",{parentName:"p",href:"/user-docs/intro"},"User Guide")," explains how to use the admin panel and the ",(0,n.kt)("a",{parentName:"p",href:"/dev-docs/admin-panel-customization"},"admin panel customization section")," details the various customization options available for the admin panel.\n:::"),(0,n.kt)("p",null,"The Strapi back end runs an HTTP server based on ",(0,n.kt)("a",{parentName:"p",href:"https://koajs.com/"},"Koa"),", a back-end JavaScript framework."),(0,n.kt)("p",null,"Like any HTTP server, the Strapi back end receives requests and send responses. You can send requests to the Strapi back end to create, retrieve, update, or delete data through the ",(0,n.kt)("a",{parentName:"p",href:"/dev-docs/api/rest"},"REST")," or ",(0,n.kt)("a",{parentName:"p",href:"/dev-docs/api/graphql"},"GraphQL")," APIs."),(0,n.kt)("p",null,"A request can travel through the Strapi back end as follows:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"The Strapi server receives a ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/requests-responses"},"request"),"."),(0,n.kt)("li",{parentName:"ol"},"The request hits ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/middlewares"},"global middlewares")," that are run in a sequential order."),(0,n.kt)("li",{parentName:"ol"},"The request hits a ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/routes"},"route"),".",(0,n.kt)("br",null),"By default, Strapi generates route files for all the content-types that you create (see ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/api/rest"},"REST API documentation"),"), and more routes can be added and configured."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/policies"},"Route policies")," act as a read-only validation step that can block access to a route. ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/routes#middlewares"},"Route middlewares")," can control the request flow and mutate the request itself before moving forward."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/controllers"},"Controllers")," execute code once a route has been reached. ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/services"},"Services")," are optional, additional code that can be used to build custom logic reusable by controllers."),(0,n.kt)("li",{parentName:"ol"},"The code executed by the controllers and services interacts with the ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/models"},"models")," that are a representation of the content data structure stored in the database.",(0,n.kt)("br",null),"Interacting with the data represented by the models is handled by the ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/api/entity-service"},"Entity Service")," and ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/api/query-engine"},"Query Engine"),"."),(0,n.kt)("li",{parentName:"ol"},"The server returns a ",(0,n.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/requests-responses"},"response"),". The response can travel back through route middlewares and global middlewares before being sent.")),(0,n.kt)("p",null,"Both global and route middlewares include an asynchronous callback function, ",(0,n.kt)("inlineCode",{parentName:"p"},"await next()"),". Depending on what is returned by the middleware, the request will either go through a shorter or longer path through the back end:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"If a middleware returns nothing, the request will continue travelling through the various core elements of the back end (i.e., controllers, services, and the other layers that interact with the database)."),(0,n.kt)("li",{parentName:"ul"},"If a middleware returns before calling ",(0,n.kt)("inlineCode",{parentName:"li"},"await next()"),", a response will be immediately sent, skipping the rest of the core elements. Then it will go back down the same chain it came up.")),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Please note that all customizations described in the pages of this section are only for the REST API. ",(0,n.kt)("a",{parentName:"p",href:"/dev-docs/plugins/graphql#customization"},"GraphQL customizations")," are described in the GraphQL plugin documentation.")),(0,n.kt)("admonition",{title:"Learn by example",type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"If you prefer learning by reading examples and understanding how they can be used in real-world use cases, the ",(0,n.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/examples"},"Examples cookbook")," section is another way at looking how the Strapi back end customization works.")),(0,n.kt)("h2",{id:"interactive-diagram"},"Interactive diagram"),(0,n.kt)("p",null,"The following diagram represents how requests travel through the Strapi back end. You can click on any shape to jump to the relevant page in the documentation."),(0,n.kt)("mermaid",{value:'graph TB\n    request[Request] ---\x3e globalMiddlewareA(("Global middleware<br/>before await next()"))\n    globalMiddlewareA --"Call next()"--\x3e routePolicy{Route policy}\n    globalMiddlewareA --"Returns before next()<br>Goes back up in the middleware chain"--\x3eglobalMiddlewareB\n    routePolicy --Returns true--\x3e routeMiddlewareA(("Route middleware<br/>before await next()"))\n    routePolicy --Returns false or an error--\x3eglobalMiddlewareB\n    routeMiddlewareA --"Returns before next()<br>Goes back up in the middleware chain"--\x3erouteMiddlewareB\n    routeMiddlewareA --"Call next()"--\x3e controllerA{{Controller}}\n    controllerA --"Call Service(s)"--\x3e serviceA{{Service}}\n    controllerA --"Don\'t call Service(s)" --\x3e routeMiddlewareB\n    serviceA --"Call Entity Service" --\x3e entityService{{Entity Service}}\n    serviceA --"Don\'t call Entity Service" --\x3e controllerB\n    entityService --"Call Query Engine"--\x3e queryEngine{{Query Engine}}\n    entityService --"Don\'t call Query Engine" --\x3e serviceB\n    queryEngine --\x3e lifecyclesBefore[/Lifecycle<br> beforeX\\] \n    lifecyclesBefore[/Lifecycle<br> beforeX\\] --\x3e database[(Database)]\n    database --\x3e lifecyclesAfter[\\Lifecycle<br> afterX/]\n    lifecyclesAfter --\x3e serviceB{{"Service<br/>after Entity Service call"}}\n    serviceB --\x3e controllerB{{"Controller<br/>after service call"}}\n    controllerB --\x3e routeMiddlewareB(("Route middleware<br/>after await next()"))\n    routeMiddlewareB --\x3e globalMiddlewareB(("Global middleware<br/>after await next()"))\n    globalMiddlewareB --\x3e response[Response]\n    linkStyle 3 stroke:green,color:green\n    linkStyle 4 stroke:red,color:red\n    linkStyle 2 stroke:purple,color:purple\n    linkStyle 5 stroke:purple,color:purple\n    click request "/dev-docs/backend-customization/requests-responses"\n    click globalMiddlewareA "/dev-docs/backend-customization/middlewares"\n    click globalMiddlewareB "/dev-docs/backend-customization/middlewares"\n    click routePolicy "/dev-docs/backend-customization/routes"\n    click routeMiddlewareA "/dev-docs/backend-customization/routes"\n    click routeMiddlewareB "/dev-docs/backend-customization/routes"\n    click controllerA "/dev-docs/backend-customization/controllers"\n    click controllerB "/dev-docs/backend-customization/controllers"\n    click serviceA "/dev-docs/backend-customization/services"\n    click serviceB "/dev-docs/backend-customization/services"\n    click entityService "/dev-docs/api/entity-service/"\n    click lifecyclesBefore "/dev-docs/backend-customization/models#lifecycle-hooks"\n    click queryEngine "/dev-docs/api/query-engine/"\n    click lifecyclesAfter "/dev-docs/backend-customization/models#lifecycle-hooks"\n    click response "/dev-docs/backend-customization/requests-responses"\n    click queryEngine "/dev-docs/api/query-engine"'}))}u.isMDXComponent=!0}}]);