"use strict";(self.webpackChunkstrapi_docs=self.webpackChunkstrapi_docs||[]).push([[7621,9599],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>m});var i=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=i.createContext({}),s=function(e){var n=i.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},d=function(e){var n=s(e.components);return i.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},g=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),g=s(t),m=a,c=g["".concat(p,".").concat(m)]||g[m]||u[m]||r;return t?i.createElement(c,o(o({ref:n},d),{},{components:t})):i.createElement(c,o({ref:n},d))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,o=new Array(r);o[0]=g;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var s=2;s<r;s++)o[s]=t[s];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}g.displayName="MDXCreateElement"},36699:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>g,frontMatter:()=>o,metadata:()=>p,toc:()=>d});var i=t(83117),a=(t(67294),t(3905)),r=t(32238);const o={title:"Migrating the front end",description:"Migrate the front end of a Strapi plugin from v3.6.x to v4.0.x with step-by-step instructions",displayed_sidebar:"devDocsSidebar"},l="v4 plugin migration: Migrating the front end",p={unversionedId:"dev-docs/migration/v3-to-v4/plugin/migrate-front-end",id:"dev-docs/migration/v3-to-v4/plugin/migrate-front-end",title:"Migrating the front end",description:"Migrate the front end of a Strapi plugin from v3.6.x to v4.0.x with step-by-step instructions",source:"@site/docs/dev-docs/migration/v3-to-v4/plugin/migrate-front-end.md",sourceDirName:"dev-docs/migration/v3-to-v4/plugin",slug:"/dev-docs/migration/v3-to-v4/plugin/migrate-front-end",permalink:"/aberabook/dev-docs/migration/v3-to-v4/plugin/migrate-front-end",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/dev-docs/migration/v3-to-v4/plugin/migrate-front-end.md",tags:[],version:"current",frontMatter:{title:"Migrating the front end",description:"Migrate the front end of a Strapi plugin from v3.6.x to v4.0.x with step-by-step instructions",displayed_sidebar:"devDocsSidebar"},sidebar:"devDocsSidebar",previous:{title:"Migrating the back end",permalink:"/aberabook/dev-docs/migration/v3-to-v4/plugin/migrate-back-end"},next:{title:"Enabling a plugin",permalink:"/aberabook/dev-docs/migration/v3-to-v4/plugin/enable-plugin"}},s={},d=[{value:"Registering the plugin with the admin panel",id:"registering-the-plugin-with-the-admin-panel",level:2},{value:"Adding a menu link",id:"adding-a-menu-link",level:2},{value:"Adding settings",id:"adding-settings",level:2},{value:"Adding reducers",id:"adding-reducers",level:2},{value:"Adding injection zones",id:"adding-injection-zones",level:2},{value:"Using the <code>Initializer</code> component",id:"using-the-initializer-component",level:2},{value:"Registering translations",id:"registering-translations",level:2}],u={toc:d};function g(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,i.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"v4-plugin-migration-migrating-the-front-end"},"v4 plugin migration: Migrating the front end"),(0,a.kt)(r.default,{components:t.components,mdxType:"PluginMigrationIntro"}),(0,a.kt)("p",null,"Migrating the front end of a plugin to Strapi v4 might require:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"updating how the plugin's front-end is ",(0,a.kt)("a",{parentName:"li",href:"#registering-the-plugin-with-the-admin-panel"},"registered")),(0,a.kt)("li",{parentName:"ul"},"updating how the plugin is ",(0,a.kt)("a",{parentName:"li",href:"#adding-a-menu-link"},"added to the amin panel menu")),(0,a.kt)("li",{parentName:"ul"},"updating how the plugin ",(0,a.kt)("a",{parentName:"li",href:"#adding-settings"},"adds settings to the admin panel")),(0,a.kt)("li",{parentName:"ul"},"updating how the plugin ",(0,a.kt)("a",{parentName:"li",href:"#adding-reducers"},"adds reducers")),(0,a.kt)("li",{parentName:"ul"},"updating how the plugin ",(0,a.kt)("a",{parentName:"li",href:"#adding-injection-zones"},"injects components to the Content Manager")),(0,a.kt)("li",{parentName:"ul"},"updating how the plugin ",(0,a.kt)("a",{parentName:"li",href:"#using-the-initializer-component"},"uses the admin panel ",(0,a.kt)("inlineCode",{parentName:"a"},"Initializer")," component")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#registering-translations"},"registering translations"))),(0,a.kt)("p",null,"Migrating the front end of a plugin to Strapi v4 should be done entirely manually."),(0,a.kt)("p",null,":::strapi Going further with the new Admin Panel APIs\nFollowing this guide should help you migrate a basic plugin with a single view. However, the ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api"},"Admin Panel APIs")," introduced in Strapi v4 allow for further customization."),(0,a.kt)("p",null,"In addition to the ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#register"},(0,a.kt)("inlineCode",{parentName:"a"},"register()")," lifecycle function"),", which is executed as soon as the plugin is loaded, a ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#bootstrap"},(0,a.kt)("inlineCode",{parentName:"a"},"bootstrap()")," lifecycle function")," executes after all plugins are loaded."),(0,a.kt)("p",null,"To add a settings link or section, use Redux reducers, hook into other plugins, and modify the user interface with injection zones, consult ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#available-actions"},'the "available actions" table')," for all available APIs and their associated lifecycle functions.\n:::"),(0,a.kt)("h2",{id:"registering-the-plugin-with-the-admin-panel"},"Registering the plugin with the admin panel"),(0,a.kt)("p",null,":::strapi v3/v4 comparison\nA Strapi v3 plugin is registered with the admin panel by using the ",(0,a.kt)("inlineCode",{parentName:"p"},"strapi.registerPlugin()")," function in the ",(0,a.kt)("inlineCode",{parentName:"p"},"<my-plugin-name>/admin/src/index.js")," file."),(0,a.kt)("p",null,"In Strapi v4, the plugin is registered within the ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#register"},(0,a.kt)("inlineCode",{parentName:"a"},"register()")," lifecycle function"),".\n:::"),(0,a.kt)("p",null,"To update the front-end registration of a plugin to Strapi v4:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"If it does not already exist, create an ",(0,a.kt)("inlineCode",{parentName:"p"},"admin/src/index.js")," file at the root of the plugin folder.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"In the ",(0,a.kt)("inlineCode",{parentName:"p"},"<plugin-name>/admin/src/index.js")," file, export a function that calls the ",(0,a.kt)("inlineCode",{parentName:"p"},"register()")," lifecycle function, passing the current Strapi application instance as an argument.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Inside the ",(0,a.kt)("inlineCode",{parentName:"p"},"register()")," lifecycle function body, call ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#registerplugin"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"registerPlugin()")," function")," on the application instance, grabbing the ",(0,a.kt)("inlineCode",{parentName:"p"},"name")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"id")," keys from the Strapi v3 configuration object.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Make sure that Strapi is aware of the plugin's front-end interface exported from ",(0,a.kt)("inlineCode",{parentName:"p"},"admin/src/index.js")," by adding the following line to the ",(0,a.kt)("inlineCode",{parentName:"p"},"<plugin-name>/strapi-admin.js")," entry file:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"module.exports = require('./admin/src').default;\n")))),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Example of a Strapi v4 plugin registration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="./src/plugins/my-plugin/admin/src/index.js"',title:'"./src/plugins/my-plugin/admin/src/index.js"'},"\nimport pluginId from './pluginId';\n\nconst pluginDescription = pluginPkg.strapi.description || pluginPkg.description;\nconst { name } = pluginPkg.strapi;\n\nexport default {\n  register(app) {\n      // executes as soon as the plugin is loaded\n      app.registerPlugin({\n        id: pluginId\n        name,\n      })\n    }\n  }\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title=".src/plugins/my-plugin/strapi-admin.js"',title:'".src/plugins/my-plugin/strapi-admin.js"'},"\nmodule.exports = require('./admin/src').default;\n"))),(0,a.kt)("h2",{id:"adding-a-menu-link"},"Adding a menu link"),(0,a.kt)("p",null,":::strapi v3/v4 comparison\nA Strapi v3 plugin adds a link to the menu in the admin panel by exporting a ",(0,a.kt)("inlineCode",{parentName:"p"},"menu")," object during the plugin registration."),(0,a.kt)("p",null,"In Strapi v4, a plugin adds a link to the menu programmatically with the ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#menu-api"},(0,a.kt)("inlineCode",{parentName:"a"},"addMenuLink()")," function")," called in the ",(0,a.kt)("inlineCode",{parentName:"p"},"register")," lifecycle.\n:::"),(0,a.kt)("p",null,"To migrate to Strapi v4, pass the ",(0,a.kt)("inlineCode",{parentName:"p"},"menu")," key from the Strapi v3 configuration object to ",(0,a.kt)("inlineCode",{parentName:"p"},"app.addMenuLink()")," with the following properties updated:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Property name and type in v3"),(0,a.kt)("th",{parentName:"tr",align:null},"Equivalent in v4"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"destination")," (String)"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"to")," (String)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"label")," (String)"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"intlLabel")," (String)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"icon")," (String)",(0,a.kt)("br",null),(0,a.kt)("br",null),(0,a.kt)("inlineCode",{parentName:"td"},"mainComponent")," (String)"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"<Icon />")," (React component)")))),(0,a.kt)("p",null,"The React-based icon component can be created in a separate file."),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Example of an PluginIcon component"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="./src/plugins/my-plugin/admin/src/components/PluginIcon/index.js"',title:'"./src/plugins/my-plugin/admin/src/components/PluginIcon/index.js"'},'\nimport React from "react";\nimport { Icon } from "@strapi/parts/Icon";\nimport { FontAwesomeIcon } from "@fortawesome/react-fontawesome";\n\nconst PluginIcon = () => (\n  <Icon as={() => <FontAwesomeIcon icon="paint-brush" />} width="16px" />\n);\n\nexport default PluginIcon;\n'))),(0,a.kt)("p",null,"In Strapi v3 the icon component is specified on the ",(0,a.kt)("inlineCode",{parentName:"p"},"mainComponent")," key, in Strapi v4 the component is passed as a dynamic import to the ",(0,a.kt)("inlineCode",{parentName:"p"},"app.addMenuLink()")," function."),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Example of adding a menu link with a custom plugin icon component"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="./src/plugins/my-plugin/admin/src/index.js"',title:'"./src/plugins/my-plugin/admin/src/index.js"'},"\nimport pluginId from './pluginId';\nimport pluginPermissions from './permissions';\nimport PluginIcon from './PluginIcon'\n\nconst pluginDescription = pluginPkg.strapi.description || pluginPkg.description;\nconst { name } = pluginPkg.strapi;\n\nexport default {\n  register(app) {\n    app.addMenuLink({\n      to: `/plugins/${pluginId}`,\n      icon: PluginIcon,\n      intlLabel: {\n        id: `${pluginId}.plugin.name`,\n        defaultMessage: 'My Plugin',\n      },\n      permissions: pluginPermissions.main,\n      Component: async () => {\n        const component = await import(/* webpackChunkName: \"my-plugin-page\" */ './pages/PluginPage');\n\n        return component;\n      },\n    });\n\n    app.registerPlugin({\n      description: pluginDescription,\n      id: pluginId\n      name\n    });\n  }\n}\n"))),(0,a.kt)("h2",{id:"adding-settings"},"Adding settings"),(0,a.kt)("p",null,":::strapi v3/v4 comparison"),(0,a.kt)("p",null,"A Strapi v3 plugin adds a settings section by exporting a ",(0,a.kt)("inlineCode",{parentName:"p"},"settings")," property during the plugin registration."),(0,a.kt)("p",null,"In Strapi v4, a plugin adds a settings section programmatically using the ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#settings-api"},"Settings API"),".\n:::"),(0,a.kt)("p",null,"To migrate to Strapi v4, depending on what your Strapi v3 plugin does, use the following table to find the appropriate Settings API method to use, and click on the method name to go to its dedicated documentation:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Action"),(0,a.kt)("th",{parentName:"tr",align:null},"Method"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Create a new settings section",(0,a.kt)("br",null)," and define new links to include in this section"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#createsettingsection"},(0,a.kt)("inlineCode",{parentName:"a"},"createSettingsSection()")))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Add link(s) to an existing settings section:",(0,a.kt)("ul",null,(0,a.kt)("li",null,"a single link"),(0,a.kt)("li",null,"multiple links"))),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("br",null),(0,a.kt)("ul",null,(0,a.kt)("li",null,(0,a.kt)("a",{parentName:"td",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#addsettingslink"},(0,a.kt)("inlineCode",{parentName:"a"},"addSettingsLink()"))),(0,a.kt)("li",null,(0,a.kt)("a",{parentName:"td",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#addsettingslinks"},(0,a.kt)("inlineCode",{parentName:"a"},"addSettingsLinks()")))))))),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Example of creating a new settings section"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/plugins/my-plugin/admin/src/index.js"',title:'"./src/plugins/my-plugin/admin/src/index.js"'},"\nimport getTrad from './utils/getTrad';\n\nregister(app) {\n  // Create the plugin's settings section\n  app.createSettingSection(\n    // created section\n    {\n      id: pluginId,\n      intlLabel: {\n        id: getTrad('Settings.section-label'),\n        defaultMessage: 'My plugin settings',\n      },\n    },\n    // links\n    [\n      {\n        intlLabel: {\n          id: 'settings.page',\n          defaultMessage: 'Setting page 1',\n        },\n        id: 'settings',\n        to: `/settings/my-plugin/`,\n        Component: async () => {\n          const component = await import(\n            /* webpackChunkName: \"my-plugin-settings-page\" */ './pages/Settings'\n          );\n\n          return component;\n        },\n        permissions: [],\n      },\n\n    ]\n  );\n\n  app.registerPlugin({\n    id: pluginId,\n    name,\n  });\n},\n"))),(0,a.kt)("h2",{id:"adding-reducers"},"Adding reducers"),(0,a.kt)("p",null,":::strapi v3/v4 comparison"),(0,a.kt)("p",null,"A Strapi v3 plugin adds reducers by exporting a ",(0,a.kt)("inlineCode",{parentName:"p"},"reducers")," property during the plugin registration."),(0,a.kt)("p",null,"In Strapi v4, a plugin adds reducers programmatically using the ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#reducers-api"},"Reducers API"),".\n:::"),(0,a.kt)("p",null,"To migrate to Strapi v4, make sure reducers are added programmatically with the ",(0,a.kt)("inlineCode",{parentName:"p"},"addReducers()")," method."),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Example of adding reducers"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/plugins/my-plugin/admin/src/index.js"',title:'"./src/plugins/my-plugin/admin/src/index.js"'},"\nimport myReducer from './components/MyCompo/reducer';\nimport myReducer1 from './components/MyCompo1/reducer';\nimport pluginId from './pluginId';\n\nconst reducers = {\n  [`${pluginId}_reducer`]: myReducer,\n  [`${pluginId}_reducer1`]: myReducer1,\n};\n\nexport default {\n  register(app) {\n    app.addReducers(reducers);\n\n    app.registerPlugin({\n      id: pluginId,\n      name,\n    });\n  },\n }\n}\n"))),(0,a.kt)("h2",{id:"adding-injection-zones"},"Adding injection zones"),(0,a.kt)("p",null,":::strapi v3/v4 comparison\nA Strapi v3 plugin can inject components into the Content Manager's Edit view, using the ",(0,a.kt)("inlineCode",{parentName:"p"},"registerField()")," method or the ",(0,a.kt)("inlineCode",{parentName:"p"},"useStrapi")," hook within the ",(0,a.kt)("inlineCode",{parentName:"p"},"Initializer")," component."),(0,a.kt)("p",null,"In Strapi v4, a plugin can inject components into several locations of the Content Manager using the ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#injection-zones-api"},"Injection Zones API"),".\n:::"),(0,a.kt)("p",null,"To migrate to Strapi v4, make sure components are injected using Strapi v4 ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#injection-zones-api"},"Injection Zones API"),". Depending on where the component should be injected, use:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"either the ",(0,a.kt)("inlineCode",{parentName:"li"},"injectContentManagerComponent()")," method to inject into ",(0,a.kt)("a",{parentName:"li",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#using-predefined-injection-zones"},"predefined injection zones")," of the Content Manager"),(0,a.kt)("li",{parentName:"ul"},"or the ",(0,a.kt)("inlineCode",{parentName:"li"},"injectComponent()")," method to inject into ",(0,a.kt)("a",{parentName:"li",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#creating-a-custom-injection-zone"},"custom zones"))),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Example of injecting a component into the Content Manager's Edit view"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title=" ./src/plugins/my-plugin/admin/src/index.js"',title:'"','./src/plugins/my-plugin/admin/src/index.js"':!0},"\nimport pluginId from './pluginId;\nimport Link from './components/Link'\n\nexport default {\n  bootstrap(app){\n    // insert a link in the 'right-links' zone of the Content Manager's edit view\n    app.injectContentManagerComponent('editView', 'right-links', {\n      name: `${pluginId}-link`,\n      Component: Link,\n    });\n  }\n}\n"))),(0,a.kt)("h2",{id:"using-the-initializer-component"},"Using the ",(0,a.kt)("inlineCode",{parentName:"h2"},"Initializer")," component"),(0,a.kt)("p",null,":::strapi v3/v4 comparison\nIn both Strapi v3 and v4, the ",(0,a.kt)("inlineCode",{parentName:"p"},"Initializer")," component is generated by default when a plugin is created. ",(0,a.kt)("inlineCode",{parentName:"p"},"Initializer")," could be used to execute some logic when the application is loading, for instance to dispatch an action after the user logs in into the admin panel."),(0,a.kt)("p",null,"In Strapi v4, the ",(0,a.kt)("inlineCode",{parentName:"p"},"Initializer")," component code has changed and uses the ",(0,a.kt)("inlineCode",{parentName:"p"},"useRef")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"useEffect"),"  React hooks to dispatch actions.\n:::"),(0,a.kt)("p",null,"The Initializer component is useful to store a global state in the application, which will be loaded before the application is rendered using Redux. To make sure the Initializer component is mounted in the application, set the ",(0,a.kt)("inlineCode",{parentName:"p"},"isReady")," key to ",(0,a.kt)("inlineCode",{parentName:"p"},"false")," when registering the plugin with ",(0,a.kt)("inlineCode",{parentName:"p"},"registerPlugin()"),"."),(0,a.kt)("p",null,"To migrate to Strapi v4, make sure the plugin uses the latest ",(0,a.kt)("inlineCode",{parentName:"p"},"Initializer")," code, which can be copied and pasted from the following code example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="./src/plugins/my-plugin/admin/src/components/Initializer/index.js"',title:'"./src/plugins/my-plugin/admin/src/components/Initializer/index.js"'},"\nimport { useEffect, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport pluginId from '../../pluginId';\n\nconst Initializer = ({ setPlugin }) => {\n  const ref = useRef();\n  ref.current = setPlugin;\n\n  useEffect(() => {\n    ref.current(pluginId);\n  }, []);\n\n  return null;\n};\n\nInitializer.propTypes = {\n  setPlugin: PropTypes.func.isRequired,\n};\n\nexport default Initializer;\n")),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Example of registering a plugin that uses the new Initializer component"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/plugins/my-plugin/admin/src/index.js"',title:'"./src/plugins/my-plugin/admin/src/index.js"'},"\nexport default {\n  register(app) {\n    app.registerPlugin({\n      id: pluginId,\n      initializer: Initializer,\n      isReady: false, // ensures the Initializer component is mounted in the application\n      name,\n    });\n  },\n }\n}\n"))),(0,a.kt)("h2",{id:"registering-translations"},"Registering translations"),(0,a.kt)("p",null,"In Strapi v4, the front-end plugin interface can export an ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/api/plugins/admin-panel-api#async-function"},"asynchronous ",(0,a.kt)("inlineCode",{parentName:"a"},"registerTrads()")," function")," for registering translation files."),(0,a.kt)("details",null,(0,a.kt)("summary",null,"Example of translation registration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'import { prefixPluginTranslations } from "@strapi/helper-plugin";\n\nexport default {\n  register(app) {\n    // register code...\n  },\n  bootstrap(app) {\n    // bootstrap code...\n  },\n  async registerTrads({ locales }) {\n    const importedTrads = await Promise.all(\n      locales.map((locale) => {\n        return import(\n          /* webpackChunkName: "[pluginId]-[request]" */ `./translations/${locale}.json`\n        )\n          .then(({ default: data }) => {\n            return {\n              data: prefixPluginTranslations(data, pluginId),\n              locale,\n            };\n          })\n          .catch(() => {\n            return {\n              data: {},\n              locale,\n            };\n          });\n      })\n    );\n\n    return Promise.resolve(importedTrads);\n  },\n};\n'))))}g.isMDXComponent=!0},32238:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var i=t(83117),a=(t(67294),t(3905));const r={},o=void 0,l={unversionedId:"snippets/plugin-migration-intro",id:"snippets/plugin-migration-intro",title:"plugin-migration-intro",description:"This guide is part of the v4 plugin migration guide designed to help you migrate a plugin from Strapi v3.6.x to v4.0.x.",source:"@site/docs/snippets/plugin-migration-intro.md",sourceDirName:"snippets",slug:"/snippets/plugin-migration-intro",permalink:"/aberabook/snippets/plugin-migration-intro",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/plugin-migration-intro.md",tags:[],version:"current",frontMatter:{}},p={},s=[],d={toc:s};function u(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,i.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This guide is part of the ",(0,a.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/migration/v3-to-v4/plugin-migration"},"v4 plugin migration guide")," designed to help you migrate a plugin from Strapi v3.6.x to v4.0.x."))}u.isMDXComponent=!0}}]);