"use strict";(self.webpackChunkstrapi_docs=self.webpackChunkstrapi_docs||[]).push([[2673,6480],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(a),m=r,k=d["".concat(l,".").concat(m)]||d[m]||c[m]||o;return a?n.createElement(k,i(i({ref:t},p),{},{components:a})):n.createElement(k,i({ref:t},p))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var u=2;u<o;u++)i[u]=a[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},94948:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>f,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=a(83117),r=(a(67294),a(3905));a(17155);const o={title:"Routes",description:"Strapi routes handle requests to your content and are auto-generated for your content-types. Routes can be customized according to your needs.",displayed_sidebar:"devDocsSidebar"},i="Routes",s={unversionedId:"dev-docs/backend-customization/routes",id:"dev-docs/backend-customization/routes",title:"Routes",description:"Strapi routes handle requests to your content and are auto-generated for your content-types. Routes can be customized according to your needs.",source:"@site/docs/dev-docs/backend-customization/routes.md",sourceDirName:"dev-docs/backend-customization",slug:"/dev-docs/backend-customization/routes",permalink:"/aberabook/dev-docs/backend-customization/routes",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/dev-docs/backend-customization/routes.md",tags:[],version:"current",frontMatter:{title:"Routes",description:"Strapi routes handle requests to your content and are auto-generated for your content-types. Routes can be customized according to your needs.",displayed_sidebar:"devDocsSidebar"},sidebar:"devDocsSidebar",previous:{title:"Requests and Responses",permalink:"/aberabook/dev-docs/backend-customization/requests-responses"},next:{title:"Policies",permalink:"/aberabook/dev-docs/backend-customization/policies"}},l={},u={width:"100%",margin:"0"},p={fontSize:"12px"},c=[{value:"Implementation",id:"implementation",level:2},{value:"Configuring core routers",id:"configuring-core-routers",level:3},{value:"Creating custom routers",id:"creating-custom-routers",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Policies",id:"policies",level:3},{value:"Middlewares",id:"middlewares",level:3},{value:"Public routes",id:"public-routes",level:3}],d=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)},m=d("Tabs"),k=d("TabItem"),g={toc:c};function f(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},g,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"routes"},"Routes"),(0,r.kt)("p",null,"Requests sent to Strapi on any URL are handled by routes. By default, Strapi generates routes for all the content-types (see ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/api/rest"},"REST API documentation"),"). Routes can be ",(0,r.kt)("a",{parentName:"p",href:"#implementation"},"added")," and configured:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"with ",(0,r.kt)("a",{parentName:"li",href:"#policies"},"policies"),", which are a way to block access to a route,"),(0,r.kt)("li",{parentName:"ul"},"and with ",(0,r.kt)("a",{parentName:"li",href:"#middlewares"},"middlewares"),", which are a way to control and change the request flow and the request itself.")),(0,r.kt)("p",null,"Once a route exists, reaching it executes some code handled by a controller (see ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/controllers"},"controllers documentation"),"). To view all existing routes and their hierarchal order, you can run ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn strapi routes:list")," (see ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/cli"},"CLI reference"),")."),(0,r.kt)("figure",{style:u},(0,r.kt)("img",{src:"/img/assets/backend-customization/diagram-routes.png",alt:"Simplified Strapi backend diagram with routes highlighted"}),(0,r.kt)("em",null,(0,r.kt)("figcaption",{style:p},"The diagram represents a simplified version of how a request travels through the Strapi back end, with routes highlighted. The backend customization introduction page includes a complete, ",(0,r.kt)("a",{href:"/dev-docs/backend-customization#interactive-diagram"},"interactive diagram"),"."))),(0,r.kt)("h2",{id:"implementation"},"Implementation"),(0,r.kt)("p",null,"Implementing a new route consists in defining it in a router file within the ",(0,r.kt)("inlineCode",{parentName:"p"},"./src/api/[apiName]/routes")," folder (see ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/project-structure"},"project structure"),")."),(0,r.kt)("p",null,"There are 2 different router file structures, depending on the use case:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"configuring ",(0,r.kt)("a",{parentName:"li",href:"#configuring-core-routers"},"core routers")),(0,r.kt)("li",{parentName:"ul"},"or creating ",(0,r.kt)("a",{parentName:"li",href:"#creating-custom-routers"},"custom routers"),".")),(0,r.kt)("h3",{id:"configuring-core-routers"},"Configuring core routers"),(0,r.kt)("p",null,"Core routers (i.e. ",(0,r.kt)("inlineCode",{parentName:"p"},"find"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"findOne"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"create"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"update"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"delete"),") correspond to ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/api/rest#endpoints"},"default routes")," automatically created by Strapi when a new ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/models#model-creation"},"content-type")," is created."),(0,r.kt)("p",null,"Strapi provides a ",(0,r.kt)("inlineCode",{parentName:"p"},"createCoreRouter")," factory function that automatically generates the core routers and allows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"passing in configuration options to each router"),(0,r.kt)("li",{parentName:"ul"},"and disabling some core routers to ",(0,r.kt)("a",{parentName:"li",href:"#creating-custom-routers"},"create custom ones"),".")),(0,r.kt)("p",null,"A core router file is a JavaScript file exporting the result of a call to ",(0,r.kt)("inlineCode",{parentName:"p"},"createCoreRouter")," with the following parameters:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"prefix")),(0,r.kt)("td",{parentName:"tr",align:null},"Allows passing in a custom prefix to add to all routers for this model (e.g. ",(0,r.kt)("inlineCode",{parentName:"td"},"/test"),")"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"String"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"only")),(0,r.kt)("td",{parentName:"tr",align:null},"Core routes that will only be loaded",(0,r.kt)("br",null),(0,r.kt)("br",null),"Anything not in this array is ignored."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Array"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"except")),(0,r.kt)("td",{parentName:"tr",align:null},"Core routes that should not be loaded",(0,r.kt)("br",null),(0,r.kt)("br",null),"This is functionally the opposite of the ",(0,r.kt)("inlineCode",{parentName:"td"},"only")," parameter."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Array"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"config")),(0,r.kt)("td",{parentName:"tr",align:null},"Configuration to handle ",(0,r.kt)("a",{parentName:"td",href:"#policies"},"policies"),", ",(0,r.kt)("a",{parentName:"td",href:"#middlewares"},"middlewares")," and ",(0,r.kt)("a",{parentName:"td",href:"#public-routes"},"public availability")," for the route"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Object"))))),(0,r.kt)("br",null),(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(k,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:"title=\"./src/api/[apiName]/routes/[routerName].js (e.g './src/api/restaurant/routes/restaurant.js')\"",title:'"./src/api/[apiName]/routes/[routerName].js',"(e.g":!0,"'./src/api/restaurant/routes/restaurant.js')\"":!0},"\nconst { createCoreRouter } = require('@strapi/strapi').factories;\n\nmodule.exports = createCoreRouter('api::restaurant.restaurant', {\n  prefix: '',\n  only: ['find', 'findOne'],\n  except: [],\n  config: {\n    find: {\n      auth: false,\n      policies: [],\n      middlewares: [],\n    },\n    findOne: {},\n    create: {},\n    update: {},\n    delete: {},\n  },\n});\n"))),(0,r.kt)(k,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:"title=\"./src/api/[apiName]/routes/[routerName].ts (e.g './src/api/restaurant/routes/restaurant.ts')\"",title:'"./src/api/[apiName]/routes/[routerName].ts',"(e.g":!0,"'./src/api/restaurant/routes/restaurant.ts')\"":!0},"\nimport { factories } from '@strapi/strapi'; \n\nexport default factories.createCoreRouter('api::restaurant.restaurant', {\n  prefix: '',\n  only: ['find', 'findOne'],\n  except: [],\n  config: {\n    find: {\n      auth: false,\n      policies: [],\n      middlewares: [],\n    },\n    findOne: {},\n    create: {},\n    update: {},\n    delete: {},\n  },\n});\n")))),(0,r.kt)("br",null),(0,r.kt)("p",null,"Generic implementation example:"),(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(k,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/restaurant.js"',title:'"./src/api/restaurant/routes/restaurant.js"'},"\nconst { createCoreRouter } = require('@strapi/strapi').factories;\n\nmodule.exports = createCoreRouter('api::restaurant.restaurant', {\n  only: ['find'],\n  config: {\n    find: {\n      auth: false,\n      policies: [],\n      middlewares: [],\n    }\n  }\n});\n"))),(0,r.kt)(k,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/restaurant.ts"',title:'"./src/api/restaurant/routes/restaurant.ts"'},"\nimport { factories } from '@strapi/strapi'; \n\nexport default factories.createCoreRouter('api::restaurant.restaurant', {\n  only: ['find'],\n  config: {\n    find: {\n      auth: false,\n      policies: [],\n      middlewares: [],\n    }\n  }\n});\n")))),(0,r.kt)("p",null,"This only allows a ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," request on the ",(0,r.kt)("inlineCode",{parentName:"p"},"/restaurants")," path from the core ",(0,r.kt)("inlineCode",{parentName:"p"},"find")," ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/controllers"},"controller")," without authentication."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"To see a possible usage for custom routes, read the ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/examples/routes"},"routes")," page of the backend customization examples cookbook.")),(0,r.kt)("h3",{id:"creating-custom-routers"},"Creating custom routers"),(0,r.kt)("p",null,"Creating custom routers consists in creating a file that exports an array of objects, each object being a route with the following parameters:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"method")),(0,r.kt)("td",{parentName:"tr",align:null},"Method associated to the route (i.e. ",(0,r.kt)("inlineCode",{parentName:"td"},"GET"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"POST"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"PUT"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"DELETE")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"PATCH"),")"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"String"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"path")),(0,r.kt)("td",{parentName:"tr",align:null},"Path to reach, starting with a forward-leading slash (e.g. ",(0,r.kt)("inlineCode",{parentName:"td"},"/articles"),")"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"String"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"handler")),(0,r.kt)("td",{parentName:"tr",align:null},"Function to execute when the route is reached.",(0,r.kt)("br",null),"Should follow this syntax: ",(0,r.kt)("inlineCode",{parentName:"td"},"<controllerName>.<actionName>")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"String"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"config"),(0,r.kt)("br",null),(0,r.kt)("br",null),(0,r.kt)("em",{parentName:"td"},"Optional")),(0,r.kt)("td",{parentName:"tr",align:null},"Configuration to handle ",(0,r.kt)("a",{parentName:"td",href:"#policies"},"policies"),", ",(0,r.kt)("a",{parentName:"td",href:"#middlewares"},"middlewares")," and ",(0,r.kt)("a",{parentName:"td",href:"#public-routes"},"public availability")," for the route",(0,r.kt)("br",null),(0,r.kt)("br",null)),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Object"))))),(0,r.kt)("br",null),(0,r.kt)("p",null,"Dynamic routes can be created using parameters and regular expressions. These parameters will be exposed in the ",(0,r.kt)("inlineCode",{parentName:"p"},"ctx.params")," object. For more details, please refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/pillarjs/path-to-regexp"},"PathToRegex")," documentation."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Routes files are loaded in alphabetical order. To load custom routes before core routes, make sure to name custom routes appropriately (e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"01-custom-routes.js")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"02-core-routes.js"),").")),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Example of a custom router using URL parameters and regular expressions for routes"),(0,r.kt)("p",null,"In the following example, the custom routes file name is prefixed with ",(0,r.kt)("inlineCode",{parentName:"p"},"01-")," to make sure the route is reached before the core routes."),(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(k,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/01-custom-restaurant.js"',title:'"./src/api/restaurant/routes/01-custom-restaurant.js"'},"\nmodule.exports = {\n  routes: [\n    { // Path defined with an URL parameter\n      method: 'POST',\n      path: '/restaurants/:id/review', \n      handler: 'restaurant.review',\n    },\n    { // Path defined with a regular expression\n      method: 'GET',\n      path: '/restaurants/:category([a-z]+)', // Only match when the URL parameter is composed of lowercase letters\n      handler: 'restaurant.findByCategory',\n    }\n  ]\n}\n"))),(0,r.kt)(k,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/01-custom-restaurant.ts"',title:'"./src/api/restaurant/routes/01-custom-restaurant.ts"'},"\nexport default {\n  routes: [\n    { // Path defined with a URL parameter\n      method: 'GET',\n      path: '/restaurants/:category/:id',\n      handler: 'Restaurant.findOneByCategory',\n    },\n    { // Path defined with a regular expression\n      method: 'GET',\n      path: '/restaurants/:region(\\\\d{2}|\\\\d{3})/:id', // Only match when the first parameter contains 2 or 3 digits.\n      handler: 'Restaurant.findOneByRegion',\n    }\n  ]\n}\n"))))),(0,r.kt)("h2",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"Both ",(0,r.kt)("a",{parentName:"p",href:"#configuring-core-routers"},"core routers")," and ",(0,r.kt)("a",{parentName:"p",href:"#creating-custom-routers"},"custom routers")," have the same configuration options. The routes configuration is defined in a ",(0,r.kt)("inlineCode",{parentName:"p"},"config")," object that can be used to handle ",(0,r.kt)("a",{parentName:"p",href:"#policies"},"policies")," and ",(0,r.kt)("a",{parentName:"p",href:"#middlewares"},"middlewares")," or to ",(0,r.kt)("a",{parentName:"p",href:"#public-routes"},"make the route public"),"."),(0,r.kt)("h3",{id:"policies"},"Policies"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/policies"},"Policies")," can be added to a route configuration:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"by pointing to a policy registered in ",(0,r.kt)("inlineCode",{parentName:"li"},"./src/policies"),", with or without passing a custom configuration"),(0,r.kt)("li",{parentName:"ul"},"or by declaring the policy implementation directly, as a function that takes ",(0,r.kt)("inlineCode",{parentName:"li"},"policyContext")," to extend ",(0,r.kt)("a",{parentName:"li",href:"https://koajs.com/#context"},"Koa's context")," (",(0,r.kt)("inlineCode",{parentName:"li"},"ctx"),") and the ",(0,r.kt)("inlineCode",{parentName:"li"},"strapi")," instance as arguments (see ",(0,r.kt)("a",{parentName:"li",href:"/dev-docs/backend-customization/routes"},"policies documentation"),")")),(0,r.kt)(m,{groupId:"core-vs-custom-router",mdxType:"Tabs"},(0,r.kt)(k,{value:"core-router",label:"Core router policy",mdxType:"TabItem"},(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(k,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/restaurant.js"',title:'"./src/api/restaurant/routes/restaurant.js"'},"\nconst { createCoreRouter } = require('@strapi/strapi').factories;\n\nmodule.exports = createCoreRouter('api::restaurant.restaurant', {\n  config: {\n    find: {\n      policies: [\n        // point to a registered policy\n        'policy-name',\n\n        // point to a registered policy with some custom configuration\n        { name: 'policy-name', config: {} }, \n        \n        // pass a policy implementation directly\n        (policyContext, config, { strapi }) => {\n          return true;\n        },\n      ]\n    }\n  }\n});\n"))),(0,r.kt)(k,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/restaurant.ts"',title:'"./src/api/restaurant/routes/restaurant.ts"'},"\nimport { factories } from '@strapi/strapi';\n\nexport default factories.createCoreRouter('api::restaurant.restaurant', {\n  config: {\n    find: {\n      policies: [\n        // point to a registered policy\n        'policy-name',\n\n        // point to a registered policy with some custom configuration\n        { name: 'policy-name', config: {} }, \n        \n        // pass a policy implementation directly\n        (policyContext, config, { strapi }) => {\n          return true;\n        },\n      ]\n    }\n  }\n});\n"))))),(0,r.kt)(k,{value:"custom-router",label:"Custom router policy",mdxType:"TabItem"},(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(k,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/custom-restaurant.js"',title:'"./src/api/restaurant/routes/custom-restaurant.js"'},"\nmodule.exports = {\n  routes: [\n    {\n      method: 'GET',\n      path: '/articles/customRoute',\n      handler: 'api::api-name.controllerName.functionName', // or 'plugin::plugin-name.controllerName.functionName' for a plugin-specific controller\n      config: {\n        policies: [\n          // point to a registered policy\n          'policy-name',\n\n          // point to a registered policy with some custom configuration\n          { name: 'policy-name', config: {} }, \n\n          // pass a policy implementation directly\n          (policyContext, config, { strapi }) => {\n            return true;\n          },\n        ]\n      },\n    },\n  ],\n};\n"))),(0,r.kt)(k,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/custom-restaurant.ts"',title:'"./src/api/restaurant/routes/custom-restaurant.ts"'},"\nexport default {\n  routes: [\n    {\n      method: 'GET',\n      path: '/articles/customRoute',\n      handler: 'api::api-name.controllerName.functionName', // or 'plugin::plugin-name.controllerName.functionName' for a plugin-specific controller\n      config: {\n        policies: [\n          // point to a registered policy\n          'policy-name',\n\n          // point to a registered policy with some custom configuration\n          { name: 'policy-name', config: {} }, \n\n          // pass a policy implementation directly\n          (policyContext, config, { strapi }) => {\n            return true;\n          },\n        ]\n      },\n    },\n  ],\n};\n")))))),(0,r.kt)("h3",{id:"middlewares"},"Middlewares"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/middlewares"},"Middlewares")," can be added to a route configuration:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"by pointing to a middleware registered in ",(0,r.kt)("inlineCode",{parentName:"li"},"./src/middlewares"),", with or without passing a custom configuration"),(0,r.kt)("li",{parentName:"ul"},"or by declaring the middleware implementation directly, as a function that takes ",(0,r.kt)("a",{parentName:"li",href:"https://koajs.com/#context"},"Koa's context")," (",(0,r.kt)("inlineCode",{parentName:"li"},"ctx"),") and the ",(0,r.kt)("inlineCode",{parentName:"li"},"strapi")," instance as arguments:")),(0,r.kt)(m,{groupId:"core-vs-custom-router",mdxType:"Tabs"},(0,r.kt)(k,{value:"core-router",label:"Core router middleware",mdxType:"TabItem"},(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(k,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/restaurant.js"',title:'"./src/api/restaurant/routes/restaurant.js"'},"\nconst { createCoreRouter } = require('@strapi/strapi').factories;\n\nmodule.exports = createCoreRouter('api::restaurant.restaurant', {\n  config: {\n    find: {\n      middlewares: [\n        // point to a registered middleware\n        'middleware-name', \n\n        // point to a registered middleware with some custom configuration\n        { name: 'middleware-name', config: {} }, \n\n        // pass a middleware implementation directly\n        (ctx, next) => {\n          return next();\n        },\n      ]\n    }\n  }\n});\n"))),(0,r.kt)(k,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/restaurant.ts"',title:'"./src/api/restaurant/routes/restaurant.ts"'},"\nimport { factories } from '@strapi/strapi';\n\nexport default factories.createCoreRouter('api::restaurant.restaurant', {\n  config: {\n    find: {\n      middlewares: [\n        // point to a registered middleware\n        'middleware-name', \n\n        // point to a registered middleware with some custom configuration\n        { name: 'middleware-name', config: {} }, \n\n        // pass a middleware implementation directly\n        (ctx, next) => {\n          return next();\n        },\n      ]\n    }\n  }\n});\n"))))),(0,r.kt)(k,{value:"custom-router",label:"Custom router middleware",mdxType:"TabItem"},(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(k,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/custom-restaurant.js"',title:'"./src/api/restaurant/routes/custom-restaurant.js"'},"\nmodule.exports = {\n  routes: [\n    {\n      method: 'GET',\n      path: '/articles/customRoute',\n      handler: 'api::api-name.controllerName.functionName', // or 'plugin::plugin-name.controllerName.functionName' for a plugin-specific controller\n      config: {\n        middlewares: [\n          // point to a registered middleware\n          'middleware-name', \n\n          // point to a registered middleware with some custom configuration\n          { name: 'middleware-name', config: {} }, \n\n          // pass a middleware implementation directly\n          (ctx, next) => {\n            return next();\n          },\n        ],\n      },\n    },\n  ],\n};\n"))),(0,r.kt)(k,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/custom-restaurant.ts"',title:'"./src/api/restaurant/routes/custom-restaurant.ts"'},"\nexport default  {\n  routes: [\n    {\n      method: 'GET',\n      path: '/articles/customRoute',\n      handler: 'api::api-name.controllerName.functionName', // or 'plugin::plugin-name.controllerName.functionName' for a plugin-specific controller\n      config: {\n        middlewares: [\n          // point to a registered middleware\n          'middleware-name', \n\n          // point to a registered middleware with some custom configuration\n          { name: 'middleware-name', config: {} }, \n\n          // pass a middleware implementation directly\n          (ctx, next) => {\n            return next();\n          },\n        ],\n      },\n    },\n  ],\n};\n")))))),(0,r.kt)("h3",{id:"public-routes"},"Public routes"),(0,r.kt)("p",null,"By default, routes are protected by Strapi's authentication system, which is based on ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/configurations/api-tokens"},"API tokens")," or on the use of the ",(0,r.kt)("a",{parentName:"p",href:"/user-docs/plugins/strapi-plugins#users-permissions-plugin"},"Users & Permissions plugin"),"."),(0,r.kt)("p",null,"In some scenarios, it can be useful to have a route publicly available and control the access outside of the normal Strapi authentication system. This can be achieved by setting the ",(0,r.kt)("inlineCode",{parentName:"p"},"auth")," configuration parameter of a route to ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),":"),(0,r.kt)(m,{groupId:"core-vs-custom-router",mdxType:"Tabs"},(0,r.kt)(k,{value:"core-router",label:"Core router with a public route",mdxType:"TabItem"},(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(k,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/restaurant.js"',title:'"./src/api/restaurant/routes/restaurant.js"'},"\nconst { createCoreRouter } = require('@strapi/strapi').factories;\n\nmodule.exports = createCoreRouter('api::restaurant.restaurant', {\n  config: {\n    find: {\n      auth: false\n    }\n  }\n});\n"))),(0,r.kt)(k,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/restaurant.ts"',title:'"./src/api/restaurant/routes/restaurant.ts"'},"\nimport { factories } from '@strapi/strapi';\n\nexport default  factories.createCoreRouter('api::restaurant.restaurant', {\n  config: {\n    find: {\n      auth: false\n    }\n  }\n});\n"))))),(0,r.kt)(k,{value:"custom-router",label:"Custom router with a public route",mdxType:"TabItem"},(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(k,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/custom-restaurant.js"',title:'"./src/api/restaurant/routes/custom-restaurant.js"'},"\nmodule.exports = {\n  routes: [\n    {\n      method: 'GET',\n      path: '/articles/customRoute',\n      handler: 'api::api-name.controllerName.functionName', // or 'plugin::plugin-name.controllerName.functionName' for a plugin-specific controller\n      config: {\n        auth: false,\n      },\n    },\n  ],\n};\n"))),(0,r.kt)(k,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/restaurant/routes/custom-restaurant.ts"',title:'"./src/api/restaurant/routes/custom-restaurant.ts"'},"\nexport default  {\n  routes: [\n    {\n      method: 'GET',\n      path: '/articles/customRoute',\n      handler: 'api::api-name.controllerName.functionName', // or 'plugin::plugin-name.controllerName.functionName' for a plugin-specific controller\n      config: {\n        auth: false,\n      },\n    },\n  ],\n};\n")))))))}f.isMDXComponent=!0},17155:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>u});var n=a(83117),r=(a(67294),a(3905));const o={},i=void 0,s={unversionedId:"snippets/backend-customization-feedback-cta",id:"snippets/backend-customization-feedback-cta",title:"backend-customization-feedback-cta",description:"We are currently reworking the Backend Customization section of the Strapi documentation. If you would like to help, please feel free to fill in this form to share with us your opinions, needs and requests.",source:"@site/docs/snippets/backend-customization-feedback-cta.md",sourceDirName:"snippets",slug:"/snippets/backend-customization-feedback-cta",permalink:"/aberabook/snippets/backend-customization-feedback-cta",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/backend-customization-feedback-cta.md",tags:[],version:"current",frontMatter:{}},l={},u=[],p={toc:u};function c(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("admonition",{title:"\ud83d\udcac Strapi team needs you to improve this documentation!",type:"callout"},(0,r.kt)("p",{parentName:"admonition"},"We are currently reworking the Backend Customization section of the Strapi documentation. If you would like to help, please feel free to fill in ",(0,r.kt)("a",{parentName:"p",href:"https://forms.gle/YS8zGUrG6FQ72dmh8"},"this form")," to share with us your opinions, needs and requests.")))}c.isMDXComponent=!0}}]);