"use strict";(self.webpackChunkstrapi_docs=self.webpackChunkstrapi_docs||[]).push([[9101,1518,4350,931,4158],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>u});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),l=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=l(e.components);return a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),c=l(n),u=i,g=c["".concat(s,".").concat(u)]||c[u]||m[u]||o;return n?a.createElement(g,r(r({ref:t},d),{},{components:n})):a.createElement(g,r({ref:t},d))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=c;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p.mdxType="string"==typeof e?e:i,r[1]=p;for(var l=2;l<o;l++)r[l]=n[l];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},55407:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>y,frontMatter:()=>l,metadata:()=>m,toc:()=>u});var a=n(83117),i=(n(67294),n(3905)),o=n(76634),r=n(81322),p=n(61770),s=n(87386);const l={title:"Migrate from 4.1.8+ to 4.1.10",displayed_sidebar:"devDocsSidebar",description:"Learn how you can migrate your Strapi application from 4.1.8+ to 4.1.10."},d="v4.1.8+ to v4.1.10 migration guide",m={unversionedId:"dev-docs/migration/v4/migration-guide-4.1.8-to-4.1.10",id:"dev-docs/migration/v4/migration-guide-4.1.8-to-4.1.10",title:"Migrate from 4.1.8+ to 4.1.10",description:"Learn how you can migrate your Strapi application from 4.1.8+ to 4.1.10.",source:"@site/docs/dev-docs/migration/v4/migration-guide-4.1.8-to-4.1.10.md",sourceDirName:"dev-docs/migration/v4",slug:"/dev-docs/migration/v4/migration-guide-4.1.8-to-4.1.10",permalink:"/aberabook/dev-docs/migration/v4/migration-guide-4.1.8-to-4.1.10",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/dev-docs/migration/v4/migration-guide-4.1.8-to-4.1.10.md",tags:[],version:"current",frontMatter:{title:"Migrate from 4.1.8+ to 4.1.10",displayed_sidebar:"devDocsSidebar",description:"Learn how you can migrate your Strapi application from 4.1.8+ to 4.1.10."},sidebar:"devDocsSidebar"},c={},u=[{value:"Upgrading the application dependencies to 4.1.10",id:"upgrading-the-application-dependencies-to-4110",level:2},{value:"Installing database migration script (optional)",id:"installing-database-migration-script-optional",level:2},{value:"Rebuild the application",id:"rebuild-the-application",level:2},{value:"Restart the application",id:"restart-the-application",level:2}],g={toc:u};function y(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"v418-to-v4110-migration-guide"},"v4.1.8+ to v4.1.10 migration guide"),(0,i.kt)("p",null,"The Strapi v4.1.8+ to v4.1.10 migration guide upgrades versions of v4.1.8 and above to v4.1.10. This migration guide is needed only for users who experienced missing MIME types on their media when uploading media through the Content API (see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/strapi/strapi/issues/12761"},"GitHub issue #12761"),"). The migration to 4.1.10 consists of 3 steps:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Upgrading the application dependencies"),(0,i.kt)("li",{parentName:"ul"},"Installing database migration script (optional)"),(0,i.kt)("li",{parentName:"ul"},"Reinitializing the application")),(0,i.kt)(o.default,{components:n.components,mdxType:"PluginsCaution"}),(0,i.kt)("h2",{id:"upgrading-the-application-dependencies-to-4110"},"Upgrading the application dependencies to 4.1.10"),(0,i.kt)("admonition",{type:"prerequisites"},(0,i.kt)("p",{parentName:"admonition"},"Stop the server before starting the upgrade.")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Upgrade all of the Strapi packages in the ",(0,i.kt)("inlineCode",{parentName:"li"},"package.json")," to ",(0,i.kt)("inlineCode",{parentName:"li"},"4.1.10"),":")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="path: ./package.json"',title:'"path:','./package.json"':!0},'\n{\n  // ...\n  "dependencies": {\n    "@strapi/strapi": "4.1.10",\n    "@strapi/plugin-users-permissions": "4.1.10",\n    "@strapi/plugin-i18n": "4.1.10",\n    // ...\n  }\n}\n\n')),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Save the edited ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json")," file.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)(s.default,{components:n.components,mdxType:"InstallCommand"}))),(0,i.kt)("h2",{id:"installing-database-migration-script-optional"},"Installing database migration script (optional)"),(0,i.kt)("p",null,"This step is only required if some files in your database have their MIME type set to ",(0,i.kt)("inlineCode",{parentName:"p"},"null")," (see GitHub issue ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/strapi/strapi/issues/12761"},"#12761"),")."),(0,i.kt)("p",null,"To make sure Strapi can load the Media Library, the following migration script file must be added to ",(0,i.kt)("inlineCode",{parentName:"p"},"./database/migrations"),". The script automatically sets MIME types for files that miss one, based on their filename. The script will be automatically executed only once at the next launch of Strapi."),(0,i.kt)("p",null,"To add the script:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"In the ",(0,i.kt)("inlineCode",{parentName:"li"},"./database/migrations")," folder, create a file named ",(0,i.kt)("inlineCode",{parentName:"li"},"2022.05.10T00.00.00.fill-files-mime-type.js"),"."),(0,i.kt)("li",{parentName:"ol"},"Copy and paste the following code into the previously created file:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="path: ./database/migrations"',title:'"path:','./database/migrations"':!0},"'use strict'\n\nconst mimeTypes = require('mime-types');\n\nconst BATCH_SIZE = 1000;\nconst FILE_TABLE = 'files';\n\nasync function up(trx) {\n  let lastId = 0;\n  while (true) {\n    const files = await trx\n      .select(['id', 'name'])\n      .from(FILE_TABLE)\n      .where('mime', null)\n      .andWhere('id', '>', lastId)\n      .orderBy('id', 'asc')\n      .limit(BATCH_SIZE);\n\n    const mimesMap = {};\n    for (let file of files) {\n      const mime = mimeTypes.lookup(file.name) || 'application/octet-stream';\n      mimesMap[mime] = mimesMap[mime] || [];\n      mimesMap[mime].push(file.id);\n    }\n\n    for (let mime of Object.keys(mimesMap)) {\n      await trx.update({ mime }).from(FILE_TABLE).whereIn('id', mimesMap[mime]);\n    }\n\n    if (files.length < BATCH_SIZE) {\n      break;\n    }\n\n    lastId = files[files.length - 1].id;\n  }\n}\n\nasync function down() {}\n\nmodule.exports = { up, down };\n")),(0,i.kt)("h2",{id:"rebuild-the-application"},"Rebuild the application"),(0,i.kt)(r.default,{components:n.components,mdxType:"BuildCommand"}),(0,i.kt)("h2",{id:"restart-the-application"},"Restart the application"),(0,i.kt)(p.default,{components:n.components,mdxType:"DevelopCommand"}))}y.isMDXComponent=!0},81322:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>g,frontMatter:()=>o,metadata:()=>p,toc:()=>l});var a=n(83117),i=(n(67294),n(3905));const o={},r=void 0,p={unversionedId:"snippets/build-npm-yarn",id:"snippets/build-npm-yarn",title:"build-npm-yarn",description:"Run the following command in your project root directory to rebuild Strapi's admin panel:",source:"@site/docs/snippets/build-npm-yarn.md",sourceDirName:"snippets",slug:"/snippets/build-npm-yarn",permalink:"/aberabook/snippets/build-npm-yarn",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/build-npm-yarn.md",tags:[],version:"current",frontMatter:{}},s={},l=[],d=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},m=d("Tabs"),c=d("TabItem"),u={toc:l};function g(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Run the following command in your project root directory to rebuild Strapi's admin panel:"),(0,i.kt)(m,{groupId:"yarn-npm",mdxType:"Tabs"},(0,i.kt)(c,{value:"yarn",label:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn build\n"))),(0,i.kt)(c,{value:"npm",label:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm run build\n")))))}g.isMDXComponent=!0},61770:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>g,frontMatter:()=>o,metadata:()=>p,toc:()=>l});var a=n(83117),i=(n(67294),n(3905));const o={},r=void 0,p={unversionedId:"snippets/develop-npm-yarn",id:"snippets/develop-npm-yarn",title:"develop-npm-yarn",description:"Run the following command in your project root directory to restart the application:",source:"@site/docs/snippets/develop-npm-yarn.md",sourceDirName:"snippets",slug:"/snippets/develop-npm-yarn",permalink:"/aberabook/snippets/develop-npm-yarn",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/develop-npm-yarn.md",tags:[],version:"current",frontMatter:{}},s={},l=[],d=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},m=d("Tabs"),c=d("TabItem"),u={toc:l};function g(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Run the following command in your project root directory to restart the application:"),(0,i.kt)(m,{groupId:"yarn-npm",mdxType:"Tabs"},(0,i.kt)(c,{value:"yarn",label:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn develop\n"))),(0,i.kt)(c,{value:"npm",label:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm run develop\n")))))}g.isMDXComponent=!0},87386:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>g,frontMatter:()=>o,metadata:()=>p,toc:()=>l});var a=n(83117),i=(n(67294),n(3905));const o={},r=void 0,p={unversionedId:"snippets/install-npm-yarn",id:"snippets/install-npm-yarn",title:"install-npm-yarn",description:"Install the upgraded version:",source:"@site/docs/snippets/install-npm-yarn.md",sourceDirName:"snippets",slug:"/snippets/install-npm-yarn",permalink:"/aberabook/snippets/install-npm-yarn",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/install-npm-yarn.md",tags:[],version:"current",frontMatter:{}},s={},l=[],d=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},m=d("Tabs"),c=d("TabItem"),u={toc:l};function g(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Install the upgraded version:"),(0,i.kt)(m,{groupId:"yarn-npm",mdxType:"Tabs"},(0,i.kt)(c,{value:"yarn",label:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn\n"))),(0,i.kt)(c,{value:"npm",label:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm install\n")))),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"If the operation doesn't work, try removing your ",(0,i.kt)("inlineCode",{parentName:"p"},"yarn.lock")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"package-lock.json"),". If that doesn't help, remove the ",(0,i.kt)("inlineCode",{parentName:"p"},"node_modules")," folder as well and try again.")))}g.isMDXComponent=!0},76634:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>o,metadata:()=>p,toc:()=>l});var a=n(83117),i=(n(67294),n(3905));const o={},r=void 0,p={unversionedId:"snippets/migrate-plugins-extension-caution",id:"snippets/migrate-plugins-extension-caution",title:"migrate-plugins-extension-caution",description:"Plugins extension that create custom code or modify existing code, will need to be updated and compared to the changes in the repository. Not updating the plugin extensions could break the application.",source:"@site/docs/snippets/migrate-plugins-extension-caution.md",sourceDirName:"snippets",slug:"/snippets/migrate-plugins-extension-caution",permalink:"/aberabook/snippets/migrate-plugins-extension-caution",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/migrate-plugins-extension-caution.md",tags:[],version:"current",frontMatter:{}},s={},l=[],d={toc:l};function m(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"}," ",(0,i.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/plugins/users-permissions"},"Plugins extension")," that create custom code or modify existing code, will need to be updated and compared to the changes in the repository. Not updating the plugin extensions could break the application.")))}m.isMDXComponent=!0}}]);