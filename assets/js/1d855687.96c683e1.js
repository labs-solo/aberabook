"use strict";(self.webpackChunkstrapi_docs=self.webpackChunkstrapi_docs||[]).push([[8826,1518,4350,931,4158],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>u});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),l=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=l(e.components);return a.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=l(n),u=i,g=c["".concat(p,".").concat(u)]||c[u]||m[u]||o;return n?a.createElement(g,r(r({ref:t},d),{},{components:n})):a.createElement(g,r({ref:t},d))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=c;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var l=2;l<o;l++)r[l]=n[l];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},20499:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>y,frontMatter:()=>l,metadata:()=>m,toc:()=>u});var a=n(83117),i=(n(67294),n(3905)),o=n(76634),r=n(81322),s=n(61770),p=n(87386);const l={title:"Migrate v4.0.0+ to v4.0.6",displayed_sidebar:"devDocsSidebar",description:"Learn how you can migrate your Strapi application from 4.0.0+ to 4.0.6."},d="v4.0.0+ to v4.0.6 migration guide",m={unversionedId:"dev-docs/migration/v4/migration-guide-4.0.0-to-4.0.6",id:"dev-docs/migration/v4/migration-guide-4.0.0-to-4.0.6",title:"Migrate v4.0.0+ to v4.0.6",description:"Learn how you can migrate your Strapi application from 4.0.0+ to 4.0.6.",source:"@site/docs/dev-docs/migration/v4/migration-guide-4.0.0-to-4.0.6.md",sourceDirName:"dev-docs/migration/v4",slug:"/dev-docs/migration/v4/migration-guide-4.0.0-to-4.0.6",permalink:"/aberabook/dev-docs/migration/v4/migration-guide-4.0.0-to-4.0.6",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/dev-docs/migration/v4/migration-guide-4.0.0-to-4.0.6.md",tags:[],version:"current",frontMatter:{title:"Migrate v4.0.0+ to v4.0.6",displayed_sidebar:"devDocsSidebar",description:"Learn how you can migrate your Strapi application from 4.0.0+ to 4.0.6."},sidebar:"devDocsSidebar"},c={},u=[{value:"Upgrading the application dependencies",id:"upgrading-the-application-dependencies",level:2},{value:"Fixing the breaking changes",id:"fixing-the-breaking-changes",level:2},{value:"Rebuild the application",id:"rebuild-the-application",level:2},{value:"Restart the application",id:"restart-the-application",level:2}],g={toc:u};function y(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"v400-to-v406-migration-guide"},"v4.0.0+ to v4.0.6 migration guide"),(0,i.kt)("p",null,"The Strapi v4.0.0+ to v4.0.6 migration guide upgrades versions of v4.0.0 and above to v4.0.6. The migration adds the ",(0,i.kt)("inlineCode",{parentName:"p"},"session")," middleware to the middleware array and configures the ",(0,i.kt)("inlineCode",{parentName:"p"},"session")," middleware. The ",(0,i.kt)("inlineCode",{parentName:"p"},"session")," middleware is based on ",(0,i.kt)("a",{parentName:"p",href:"/dev-docs/configurations/middlewares#session"},"koa-session")," and is necessary to fix the login provider feature of the ",(0,i.kt)("a",{parentName:"p",href:"/dev-docs/plugins/users-permissions"},"Users & Permissions plugin"),". Additionally, password protection in the ",(0,i.kt)("a",{parentName:"p",href:"/dev-docs/plugins/documentation"},"Documentation plugin")," uses the ",(0,i.kt)("inlineCode",{parentName:"p"},"session")," middleware. The migration guide consists of 3 sections:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"upgrading the application dependencies"),(0,i.kt)("li",{parentName:"ul"},"migrating the breaking changes to the middleware"),(0,i.kt)("li",{parentName:"ul"},"reinitializing the application")),(0,i.kt)(o.default,{components:n.components,mdxType:"PluginsCaution"}),(0,i.kt)("h2",{id:"upgrading-the-application-dependencies"},"Upgrading the application dependencies"),(0,i.kt)("p",null,"Upgrade all of the Strapi packages in the ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"4.0.6"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="path: ./package.json"',title:'"path:','./package.json"':!0},'\n{\n  // ...\n  "dependencies": {\n    "@strapi/strapi": "4.0.6",\n    "@strapi/plugin-users-permissions": "4.0.6",\n    "@strapi/plugin-i18n": "4.0.6",\n    "sqlite3": "5.0.2"\n    // ...\n  }\n}\n\n')),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Save the edited ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json")," file.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)(p.default,{components:n.components,mdxType:"InstallCommand"}))),(0,i.kt)("h2",{id:"fixing-the-breaking-changes"},"Fixing the breaking changes"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Add the ",(0,i.kt)("inlineCode",{parentName:"li"},"strapi::session")," middleware to the array in the middleware configuration file ",(0,i.kt)("inlineCode",{parentName:"li"},"./config/middlewares.js"),":")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="path: ./config/middlewares.js"',title:'"path:','./config/middlewares.js"':!0},"\nmodule.exports = [\n  'strapi::errors',\n  'strapi::security',\n  'strapi::cors',\n  'strapi::poweredBy',\n  'strapi::logger',\n  'strapi::query',\n  'strapi::body',\n  'strapi::session',\n  'strapi::favicon',\n  'strapi::public',\n];\n")),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"Configure the session middleware by adding the key settings to the ",(0,i.kt)("inlineCode",{parentName:"li"},"server.js")," configuration file (see ",(0,i.kt)("a",{parentName:"li",href:"/dev-docs/configurations/middlewares#session"},"session middleware")," for more information). The secrets are typically stored in ",(0,i.kt)("inlineCode",{parentName:"li"},".env")," during development. In most use cases the keys will be different for each environment. For example, a different set of keys should be used for the production and the development environments. Storing default keys in the configuration file is not recommended.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="path: ./config/server.js"',title:'"path:','./config/server.js"':!0},'\n  // ...\n  app: {\n    keys: env.array("APP_KEYS"),\n  },\n// ...\n')),(0,i.kt)("details",null,(0,i.kt)("summary",null," Example of the updated file"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="path: ./config/server.js"',title:'"path:','./config/server.js"':!0},"\nmodule.exports = ({ env }) => ({\n  host: env('HOST', '0.0.0.0'),\n  port: env.int('PORT', 1337),\n  app: {\n    keys: env.array(\"APP_KEYS\"),\n  },\n  // ...\n});\n\n"))),(0,i.kt)("admonition",{type:"warning"},(0,i.kt)("p",{parentName:"admonition"},"It is a security risk to expose static session middleware keys in a deployed environment. An ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file or environment variables should be used instead."),(0,i.kt)("details",null,(0,i.kt)("summary",null," Example: sessions keys in .env file"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"APP_KEYS=[someSecret, anotherSecret, additionalSecrets]\n\nor\n\nAPP_KEYS=someSecret,anotherSecret,additionalSecrets\n")))),(0,i.kt)("h2",{id:"rebuild-the-application"},"Rebuild the application"),(0,i.kt)(r.default,{components:n.components,mdxType:"BuildCommand"}),(0,i.kt)("h2",{id:"restart-the-application"},"Restart the application"),(0,i.kt)(s.default,{components:n.components,mdxType:"DevelopCommand"}))}y.isMDXComponent=!0},81322:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=n(83117),i=(n(67294),n(3905));const o={},r=void 0,s={unversionedId:"snippets/build-npm-yarn",id:"snippets/build-npm-yarn",title:"build-npm-yarn",description:"Run the following command in your project root directory to rebuild Strapi's admin panel:",source:"@site/docs/snippets/build-npm-yarn.md",sourceDirName:"snippets",slug:"/snippets/build-npm-yarn",permalink:"/aberabook/snippets/build-npm-yarn",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/build-npm-yarn.md",tags:[],version:"current",frontMatter:{}},p={},l=[],d=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},m=d("Tabs"),c=d("TabItem"),u={toc:l};function g(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Run the following command in your project root directory to rebuild Strapi's admin panel:"),(0,i.kt)(m,{groupId:"yarn-npm",mdxType:"Tabs"},(0,i.kt)(c,{value:"yarn",label:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn build\n"))),(0,i.kt)(c,{value:"npm",label:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm run build\n")))))}g.isMDXComponent=!0},61770:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=n(83117),i=(n(67294),n(3905));const o={},r=void 0,s={unversionedId:"snippets/develop-npm-yarn",id:"snippets/develop-npm-yarn",title:"develop-npm-yarn",description:"Run the following command in your project root directory to restart the application:",source:"@site/docs/snippets/develop-npm-yarn.md",sourceDirName:"snippets",slug:"/snippets/develop-npm-yarn",permalink:"/aberabook/snippets/develop-npm-yarn",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/develop-npm-yarn.md",tags:[],version:"current",frontMatter:{}},p={},l=[],d=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},m=d("Tabs"),c=d("TabItem"),u={toc:l};function g(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Run the following command in your project root directory to restart the application:"),(0,i.kt)(m,{groupId:"yarn-npm",mdxType:"Tabs"},(0,i.kt)(c,{value:"yarn",label:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn develop\n"))),(0,i.kt)(c,{value:"npm",label:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm run develop\n")))))}g.isMDXComponent=!0},87386:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=n(83117),i=(n(67294),n(3905));const o={},r=void 0,s={unversionedId:"snippets/install-npm-yarn",id:"snippets/install-npm-yarn",title:"install-npm-yarn",description:"Install the upgraded version:",source:"@site/docs/snippets/install-npm-yarn.md",sourceDirName:"snippets",slug:"/snippets/install-npm-yarn",permalink:"/aberabook/snippets/install-npm-yarn",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/install-npm-yarn.md",tags:[],version:"current",frontMatter:{}},p={},l=[],d=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},m=d("Tabs"),c=d("TabItem"),u={toc:l};function g(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Install the upgraded version:"),(0,i.kt)(m,{groupId:"yarn-npm",mdxType:"Tabs"},(0,i.kt)(c,{value:"yarn",label:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn\n"))),(0,i.kt)(c,{value:"npm",label:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm install\n")))),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"If the operation doesn't work, try removing your ",(0,i.kt)("inlineCode",{parentName:"p"},"yarn.lock")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"package-lock.json"),". If that doesn't help, remove the ",(0,i.kt)("inlineCode",{parentName:"p"},"node_modules")," folder as well and try again.")))}g.isMDXComponent=!0},76634:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=n(83117),i=(n(67294),n(3905));const o={},r=void 0,s={unversionedId:"snippets/migrate-plugins-extension-caution",id:"snippets/migrate-plugins-extension-caution",title:"migrate-plugins-extension-caution",description:"Plugins extension that create custom code or modify existing code, will need to be updated and compared to the changes in the repository. Not updating the plugin extensions could break the application.",source:"@site/docs/snippets/migrate-plugins-extension-caution.md",sourceDirName:"snippets",slug:"/snippets/migrate-plugins-extension-caution",permalink:"/aberabook/snippets/migrate-plugins-extension-caution",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/snippets/migrate-plugins-extension-caution.md",tags:[],version:"current",frontMatter:{}},p={},l=[],d={toc:l};function m(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"}," ",(0,i.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/plugins/users-permissions"},"Plugins extension")," that create custom code or modify existing code, will need to be updated and compared to the changes in the repository. Not updating the plugin extensions could break the application.")))}m.isMDXComponent=!0}}]);