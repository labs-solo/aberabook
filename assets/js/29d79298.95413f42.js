"use strict";(self.webpackChunkstrapi_docs=self.webpackChunkstrapi_docs||[]).push([[454],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>u});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var d=a.createContext({}),s=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(d.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,d=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=s(n),u=i,k=c["".concat(d,".").concat(u)]||c[u]||m[u]||r;return n?a.createElement(k,l(l({ref:t},p),{},{components:n})):a.createElement(k,l({ref:t},p))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=c;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var s=2;s<r;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},16998:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>k,frontMatter:()=>r,metadata:()=>o,toc:()=>s});var a=n(83117),i=(n(67294),n(3905));const r={title:"Email",displayed_sidebar:"devDocsSidebar",description:"Send email from your server or externals providers."},l="Email plugin",o={unversionedId:"dev-docs/plugins/email",id:"dev-docs/plugins/email",title:"Email",description:"Send email from your server or externals providers.",source:"@site/docs/dev-docs/plugins/email.md",sourceDirName:"dev-docs/plugins",slug:"/dev-docs/plugins/email",permalink:"/aberabook/dev-docs/plugins/email",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/dev-docs/plugins/email.md",tags:[],version:"current",frontMatter:{title:"Email",displayed_sidebar:"devDocsSidebar",description:"Send email from your server or externals providers."},sidebar:"devDocsSidebar",previous:{title:"Documentation",permalink:"/aberabook/dev-docs/plugins/documentation"},next:{title:"GraphQL",permalink:"/aberabook/dev-docs/plugins/graphql"}},d={},s=[{value:"Sending emails with a controller or service",id:"sending-emails-with-a-controller-or-service",level:2},{value:"Using the <code>send()</code> function",id:"using-the-send-function",level:3},{value:"Using the <code>sendTemplatedEmail()</code> function",id:"using-the-sendtemplatedemail-function",level:3},{value:"Sending emails with a lifecycle hook",id:"sending-emails-with-a-lifecycle-hook",level:2}],p=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},m=p("Tabs"),c=p("TabItem"),u={toc:s};function k(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"email-plugin"},"Email plugin"),(0,i.kt)("p",null,"The Email plugin enables applications to send emails from a server or an external provider. The Email plugin uses the Strapi global API, meaning it can be called from anywhere inside a Strapi application. Two of the most common use cases are in the Strapi back end and in the admin panel. The following documentation describes how to use the Email plugin in a controller or service for back-end use cases and using a lifecycle hook for admin panel use cases."),(0,i.kt)("admonition",{type:"prerequisites"},(0,i.kt)("p",{parentName:"admonition"},"The Email plugin requires a provider and a provider configuration in the ",(0,i.kt)("inlineCode",{parentName:"p"},"config/plugins.js")," file or ",(0,i.kt)("inlineCode",{parentName:"p"},"config/plugins.ts")," file. See the ",(0,i.kt)("a",{parentName:"p",href:"/dev-docs/providers"},"Providers")," documentation for detailed installation and configuration instructions.")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/sendmail"},(0,i.kt)("inlineCode",{parentName:"a"},"Sendmail"))," is the default email provider in the Strapi Email plugin. It provides functionality for the local development environment but is not production-ready in the default configuration. For production stage applications you need to further configure ",(0,i.kt)("inlineCode",{parentName:"p"},"Sendmail")," (refer to its ",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/sendmail"},"README on npm"),") or change providers. The ",(0,i.kt)("a",{parentName:"p",href:"/dev-docs/providers"},"Providers")," documentation has instructions for changing providers, configuring providers, and creating a new email provider.")),(0,i.kt)("h2",{id:"sending-emails-with-a-controller-or-service"},"Sending emails with a controller or service"),(0,i.kt)("p",null,"The Email plugin has an ",(0,i.kt)("inlineCode",{parentName:"p"},"email")," ",(0,i.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/services#services"},"service")," that contains 2 functions to send emails:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"send()")," directly contains the email contents,"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sendTemplatedEmail()")," consumes data from the Content Manager to populate emails, streamlining programmatic emails.")),(0,i.kt)("h3",{id:"using-the-send-function"},"Using the ",(0,i.kt)("inlineCode",{parentName:"h3"},"send()")," function"),(0,i.kt)("p",null,"To trigger an email in response to a user action add the ",(0,i.kt)("inlineCode",{parentName:"p"},"send()")," function to a ",(0,i.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/controllers"},"controller")," or ",(0,i.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/services"},"service"),". The send function has the following properties:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Property"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Format"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"from")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"string")),(0,i.kt)("td",{parentName:"tr",align:null},"email address"),(0,i.kt)("td",{parentName:"tr",align:null},"If not specified, uses ",(0,i.kt)("inlineCode",{parentName:"td"},"defaultFrom")," in ",(0,i.kt)("inlineCode",{parentName:"td"},"plugins.js"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"to")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"string")),(0,i.kt)("td",{parentName:"tr",align:null},"email address"),(0,i.kt)("td",{parentName:"tr",align:null},"Required")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"cc")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"string")),(0,i.kt)("td",{parentName:"tr",align:null},"email address"),(0,i.kt)("td",{parentName:"tr",align:null},"Optional")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"bcc")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"string")),(0,i.kt)("td",{parentName:"tr",align:null},"email address"),(0,i.kt)("td",{parentName:"tr",align:null},"Optional")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"replyTo")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"string")),(0,i.kt)("td",{parentName:"tr",align:null},"email address"),(0,i.kt)("td",{parentName:"tr",align:null},"Optional")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"subject")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"string")),(0,i.kt)("td",{parentName:"tr",align:null},"-"),(0,i.kt)("td",{parentName:"tr",align:null},"Required")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"text")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"string")),(0,i.kt)("td",{parentName:"tr",align:null},"-"),(0,i.kt)("td",{parentName:"tr",align:null},"Either ",(0,i.kt)("inlineCode",{parentName:"td"},"text")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"html")," is required.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"html")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"string")),(0,i.kt)("td",{parentName:"tr",align:null},"HTML"),(0,i.kt)("td",{parentName:"tr",align:null},"Either ",(0,i.kt)("inlineCode",{parentName:"td"},"text")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"html")," is required.")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="This code example can be used in a controller or a service path: ./src/api/{api name}/controllers/{api name}.js or ./src/api/{api name}/services/{api name}.js"',title:'"This',code:!0,example:!0,can:!0,be:!0,used:!0,in:!0,a:!0,controller:!0,or:!0,service:!0,"path:":!0,"./src/api/{api":!0,"name}/controllers/{api":!0,"name}.js":!0,"name}/services/{api":!0,'name}.js"':!0},"\n  await strapi.plugins['email'].services.email.send({\n    to: 'valid email address',\n    from: 'your verified email address', //e.g. single sender verification in SendGrid\n    cc: 'valid email address',\n    bcc: 'valid email address',\n    replyTo: 'valid email address',\n    subject: 'The Strapi Email plugin worked successfully',\n    text: 'Hello world!',\n    html: 'Hello world!',\n  }),\n")),(0,i.kt)("h3",{id:"using-the-sendtemplatedemail-function"},"Using the ",(0,i.kt)("inlineCode",{parentName:"h3"},"sendTemplatedEmail()")," function"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"sendTemplatedEmail()")," function is used to compose emails from a template. The function compiles the email from the available properties and then sends the email. To use the ",(0,i.kt)("inlineCode",{parentName:"p"},"sendTemplatedEmail()")," function, define the ",(0,i.kt)("inlineCode",{parentName:"p"},"emailTemplate")," object and add the function to a controller or service. The function calls the ",(0,i.kt)("inlineCode",{parentName:"p"},"emailTemplate")," object, and can optionally call the ",(0,i.kt)("inlineCode",{parentName:"p"},"emailOptions")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"data")," objects:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Default"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"emailOptions")," ",(0,i.kt)("br",null)," Optional"),(0,i.kt)("td",{parentName:"tr",align:null},"Contains email addressing properties: ",(0,i.kt)("inlineCode",{parentName:"td"},"to"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"from"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"replyTo"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"cc"),", and ",(0,i.kt)("inlineCode",{parentName:"td"},"bcc")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"object")),(0,i.kt)("td",{parentName:"tr",align:null},"{ }")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"emailTemplate")),(0,i.kt)("td",{parentName:"tr",align:null},"Contains email content properties: ",(0,i.kt)("inlineCode",{parentName:"td"},"subject"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"text"),", and ",(0,i.kt)("inlineCode",{parentName:"td"},"html")," using ",(0,i.kt)("a",{parentName:"td",href:"https://lodash.com/docs/4.17.15#template"},"Lodash string templates")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"object")),(0,i.kt)("td",{parentName:"tr",align:null},"{ }")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"data"),"  ",(0,i.kt)("br",null)," Optional"),(0,i.kt)("td",{parentName:"tr",align:null},"Contains the data used to compile the templates"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"object")),(0,i.kt)("td",{parentName:"tr",align:null},"{ }")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="This code example can be used in a controller or a service path: ./src/api/{api name}/controllers/{api name}.js or ./src/api/{api name}/services/{api name}.js"',title:'"This',code:!0,example:!0,can:!0,be:!0,used:!0,in:!0,a:!0,controller:!0,or:!0,service:!0,"path:":!0,"./src/api/{api":!0,"name}/controllers/{api":!0,"name}.js":!0,"name}/services/{api":!0,'name}.js"':!0},"\n\nconst emailTemplate = {\n  subject: 'Welcome <%= user.firstname %>',\n  text: `Welcome to mywebsite.fr!\n    Your account is now linked with: <%= user.email %>.`,\n  html: `<h1>Welcome to mywebsite.fr!</h1>\n    <p>Your account is now linked with: <%= user.email %>.<p>`,\n};\n\nawait strapi.plugins['email'].services.email.sendTemplatedEmail(\n  {\n    to: user.email,\n    // from: is not specified, the defaultFrom is used.\n  },\n    emailTemplate,\n  {\n    user: _.pick(user, ['username', 'email', 'firstname', 'lastname']),\n  }\n);\n")),(0,i.kt)("h2",{id:"sending-emails-with-a-lifecycle-hook"},"Sending emails with a lifecycle hook"),(0,i.kt)("p",null," To trigger an email based on administrator actions in the admin panel use ",(0,i.kt)("a",{parentName:"p",href:"/dev-docs/backend-customization/models#lifecycle-hooks"},"lifecycle hooks")," and the ",(0,i.kt)("a",{parentName:"p",href:"#using-the-send-function"},(0,i.kt)("inlineCode",{parentName:"a"},"send()")," function"),". For example, to send an email each time a new content entry is added in the Content Manager use the ",(0,i.kt)("inlineCode",{parentName:"p"},"afterCreate")," lifecycle hook:"),(0,i.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,i.kt)(c,{value:"javascript",label:"JavaScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./src/api/{api-name}/content-types/{content-type-name}/lifecycles.js"',title:'"./src/api/{api-name}/content-types/{content-type-name}/lifecycles.js"'},"\nmodule.exports = {\n    async afterCreate(event) {    // Connected to \"Save\" button in admin panel\n        const { result } = event;\n\n        try{\n            await strapi.plugins['email'].services.email.send({\n              to: 'valid email address',\n              from: 'your verified email address', // e.g. single sender verification in SendGrid\n              cc: 'valid email address',\n              bcc: 'valid email address',\n              replyTo: 'valid email address',\n              subject: 'The Strapi Email plugin worked successfully',\n              text: '${fieldName}', // Replace with a valid field ID\n              html: 'Hello world!', \n                \n            })\n        } catch(err) {\n            console.log(err);\n        }\n    }\n}\n"))),(0,i.kt)(c,{value:"typescript",label:"TypeScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="./src/api/{api-name}/content-types/{content-type-name}/lifecycles.js"',title:'"./src/api/{api-name}/content-types/{content-type-name}/lifecycles.js"'},"\nexport default {\n    async afterCreate(event) {    // Connected to \"Save\" button in admin panel\n        const { result } = event;\n\n        try{\n            await strapi.plugins['email'].services.email.send({\n              to: 'valid email address',\n              from: 'your verified email address', // e.g. single sender verification in SendGrid\n              cc: 'valid email address',\n              bcc: 'valid email address',\n              replyTo: 'valid email address',\n              subject: 'The Strapi Email plugin worked successfully',\n              text: '${fieldName}', // Replace with a valid field ID\n              html: 'Hello world!', \n                \n            })\n        } catch(err) {\n            console.log(err);\n        }\n    }\n}\n\n")))))}k.isMDXComponent=!0}}]);