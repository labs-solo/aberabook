"use strict";(self.webpackChunkstrapi_docs=self.webpackChunkstrapi_docs||[]).push([[7405],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>u});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),l=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=l(e.components);return n.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(a),u=r,g=d["".concat(p,".").concat(u)]||d[u]||m[u]||o;return a?n.createElement(g,i(i({ref:t},c),{},{components:a})):n.createElement(g,i({ref:t},c))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<o;l++)i[l]=a[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},90409:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var n=a(83117),r=(a(67294),a(3905));const o={title:"Process Manager",description:"How to install and start a Strapi application using a process manager.",sidebarDepth:2},i="Process manager",s={unversionedId:"dev-docs/deployment/process-manager",id:"dev-docs/deployment/process-manager",title:"Process Manager",description:"How to install and start a Strapi application using a process manager.",source:"@site/docs/dev-docs/deployment/process-manager.md",sourceDirName:"dev-docs/deployment",slug:"/dev-docs/deployment/process-manager",permalink:"/aberabook/dev-docs/deployment/process-manager",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/dev-docs/deployment/process-manager.md",tags:[],version:"current",frontMatter:{title:"Process Manager",description:"How to install and start a Strapi application using a process manager.",sidebarDepth:2},sidebar:"devDocsSidebar",previous:{title:"Nginx Proxying",permalink:"/aberabook/dev-docs/deployment/nginx-proxy"},next:{title:"Strapi Content API",permalink:"/aberabook/dev-docs/api/content-api"}},p={},l=[{value:"Install PM2",id:"install-pm2",level:2},{value:"Start PM2 with a <code>server.js</code> file",id:"start-pm2-with-a-serverjs-file",level:2},{value:"Start PM2 with the <code>strapi</code> command",id:"start-pm2-with-the-strapi-command",level:2},{value:"Start and configure PM2 with a <code>config.js</code> file",id:"start-and-configure-pm2-with-a-configjs-file",level:2}],c=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)},m=c("Tabs"),d=c("TabItem"),u={toc:l};function g(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"process-manager"},"Process manager"),(0,r.kt)("p",null,"Process managers allow you to keep your Strapi application running and to reload it without downtime. The following documentation uses the ",(0,r.kt)("a",{parentName:"p",href:"https://pm2.keymetrics.io/"},"PM2")," process manager and describes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"installing PM2,"),(0,r.kt)("li",{parentName:"ul"},"starting Strapi using a ",(0,r.kt)("inlineCode",{parentName:"li"},"server.js")," file,"),(0,r.kt)("li",{parentName:"ul"},"starting Strapi using the ",(0,r.kt)("inlineCode",{parentName:"li"},"strapi")," command,"),(0,r.kt)("li",{parentName:"ul"},"starting and managing Strapi using an ",(0,r.kt)("inlineCode",{parentName:"li"},"ecosystem.config.js")," file.")),(0,r.kt)("p",null,"The appropriate procedure for starting PM2 depends on the hosting provider and your application configuration."),(0,r.kt)("h2",{id:"install-pm2"},"Install PM2"),(0,r.kt)("p",null,"Install PM2 globally:"),(0,r.kt)(m,{groupId:"yarn-npm",mdxType:"Tabs"},(0,r.kt)(d,{value:"yarn",label:"yarn",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn global add pm2\n"))),(0,r.kt)(d,{value:"npm",label:"npm",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install pm2 -g\n")))),(0,r.kt)("h2",{id:"start-pm2-with-a-serverjs-file"},"Start PM2 with a ",(0,r.kt)("inlineCode",{parentName:"h2"},"server.js")," file"),(0,r.kt)("p",null,"The basic usage to start an application with PM2 is to run a command such as ",(0,r.kt)("inlineCode",{parentName:"p"},"pm2 start server.js"),". To configure and run your application:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Create a ",(0,r.kt)("inlineCode",{parentName:"li"},"server.js")," file at the application root."),(0,r.kt)("li",{parentName:"ol"},"Add the following code snippet to the ",(0,r.kt)("inlineCode",{parentName:"li"},"server.js")," file:")),(0,r.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,r.kt)(d,{value:"javascript",label:"JavaScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="path: ./server.js"',title:'"path:','./server.js"':!0},"\nconst strapi = require('@strapi/strapi');\nstrapi().start();\n"))),(0,r.kt)(d,{value:"typescript",label:"TypeScript",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="path: ./server.js"',title:'"path:','./server.js"':!0},'const strapi = require("@strapi/strapi");\nconst app = strapi({ distDir: "./dist" });\napp.start();\n')))),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Start the server by running ",(0,r.kt)("inlineCode",{parentName:"li"},"pm2 start server.js")," in the project root directory.")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"TypeScript projects require additional code in the ",(0,r.kt)("inlineCode",{parentName:"p"},"server.js")," file to identify the correct directory. See the previous TypeScript code example or the ",(0,r.kt)("a",{parentName:"p",href:"/dev-docs/typescript#start-strapi-programmatically"},"TypeScript documentation")," for additional details.")),(0,r.kt)("h2",{id:"start-pm2-with-the-strapi-command"},"Start PM2 with the ",(0,r.kt)("inlineCode",{parentName:"h2"},"strapi")," command"),(0,r.kt)("p",null,"To start PM2 and your application from a terminal you should start PM2 and pass the application name and start command as arguments:"),(0,r.kt)(m,{groupId:"yarn-npm",mdxType:"Tabs"},(0,r.kt)(d,{value:"yarn",label:"yarn",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"pm2 start yarn --name app -- start\n\n"))),(0,r.kt)(d,{value:"npm",label:"npm",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"pm2 start npm --name app -- run start\n\n")))),(0,r.kt)("h2",{id:"start-and-configure-pm2-with-a-configjs-file"},"Start and configure PM2 with a ",(0,r.kt)("inlineCode",{parentName:"h2"},"config.js")," file"),(0,r.kt)("p",null,"A PM2 configuration file allows you to save the information necessary to start your server properly at any time. This is commonly used for cloud hosting providers, where you might not have access to a terminal window to start the server. To use a configuration file:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Run ",(0,r.kt)("inlineCode",{parentName:"li"},"pm2 init")," at the application root to create an ",(0,r.kt)("inlineCode",{parentName:"li"},"ecosystem.config.js")," file."),(0,r.kt)("li",{parentName:"ol"},"Replace the ",(0,r.kt)("inlineCode",{parentName:"li"},"ecosystem.config.js")," file content with the following code example:")),(0,r.kt)(m,{groupId:"yarn-npm",mdxType:"Tabs"},(0,r.kt)(d,{value:"yarn",label:"yarn",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="path: ./ecosystem.config.js"',title:'"path:','./ecosystem.config.js"':!0},"module.exports = {\n      apps: [\n        {\n          name: 'app',\n          script: 'yarn',\n          args: 'start',\n        },\n      ],\n    };\n"))),(0,r.kt)(d,{value:"npm",label:"npm",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="path: ./ecosystem.config.js"',title:'"path:','./ecosystem.config.js"':!0},"module.exports = {\n      apps: [\n        {\n          name: 'app',\n          script: 'npm',\n          args: 'start',\n        },\n      ],\n    };\n")))),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Run ",(0,r.kt)("inlineCode",{parentName:"li"},"pm2 start ecosystem.config.js")," to start the PM2 process.")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"ecosystem.config.js")," code example is the minimum configuration. The ",(0,r.kt)("a",{parentName:"p",href:"https://pm2.keymetrics.io/docs/usage/application-declaration/"},"PM2 ecosystem file documentation")," provides all of the configuration options.")))}g.isMDXComponent=!0}}]);