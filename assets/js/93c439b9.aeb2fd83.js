"use strict";(self.webpackChunkstrapi_docs=self.webpackChunkstrapi_docs||[]).push([[2341],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>u});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(n),u=i,k=c["".concat(s,".").concat(u)]||c[u]||m[u]||r;return n?a.createElement(k,o(o({ref:t},d),{},{components:n})):a.createElement(k,o({ref:t},d))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},70983:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>k,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var a=n(83117),i=(n(67294),n(3905));const r={title:"Database",displayed_sidebar:"devDocsConfigSidebar",description:"Strapi offers a single entry point file to configure its databases."},o="Database configuration",l={unversionedId:"dev-docs/configurations/database",id:"dev-docs/configurations/database",title:"Database",description:"Strapi offers a single entry point file to configure its databases.",source:"@site/docs/dev-docs/configurations/database.md",sourceDirName:"dev-docs/configurations",slug:"/dev-docs/configurations/database",permalink:"/aberabook/dev-docs/configurations/database",draft:!1,editUrl:"https://github.com/labs-solo/aberabook/edit/main/docusaurus/docs/dev-docs/configurations/database.md",tags:[],version:"current",frontMatter:{title:"Database",displayed_sidebar:"devDocsConfigSidebar",description:"Strapi offers a single entry point file to configure its databases."},sidebar:"devDocsConfigSidebar",previous:{title:"Configurations",permalink:"/aberabook/dev-docs/configurations"},next:{title:"Server",permalink:"/aberabook/dev-docs/configurations/server"}},s={},p=[{value:"Configuration structure",id:"configuration-structure",level:2},{value:"<code>connection</code> configuration object",id:"connection-configuration-object",level:3},{value:"Connection parameters",id:"connection-parameters",level:4},{value:"Database pooling options",id:"database-pooling-options",level:4},{value:"<code>settings</code> configuration object",id:"settings-configuration-object",level:3},{value:"Configuration examples",id:"configuration-examples",level:3},{value:"Configuration in database",id:"configuration-in-database",level:2},{value:"Get settings",id:"get-settings",level:3},{value:"Set settings",id:"set-settings",level:3},{value:"Environment variables in database configurations",id:"environment-variables-in-database-configurations",level:2},{value:"Environment variables for Strapi applications before <code>v4.6.2</code>",id:"environment-variables-for-strapi-applications-before-v462",level:3},{value:"Database connections using <code>connectionString</code>",id:"database-connections-using-connectionstring",level:3},{value:"Database management by environment",id:"database-management-by-environment",level:3},{value:"Databases installation guides",id:"databases-installation-guides",level:2},{value:"Alternative database driver packages",id:"alternative-database-driver-packages",level:3}],d=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},m=d("Tabs"),c=d("TabItem"),u={toc:p};function k(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"database-configuration"},"Database configuration"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.js")," file (or the ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.ts")," file for TypeScript) is used to define database connections that will be used to store the application content."),(0,i.kt)("admonition",{type:"warning"},(0,i.kt)("p",{parentName:"admonition"}," Strapi applications are not meant to be connected to a pre-existing database, not created by a Strapi application, nor connected to a Strapi v3 database. The Strapi team will not support such attempts. Attempting to connect to an unsupported database may, and most likely will, result in lost data.")),(0,i.kt)("p",null,":::strapi Supported databases\nThe CLI installation guide details ",(0,i.kt)("a",{parentName:"p",href:"/aberabook/dev-docs/installation/cli#preparing-the-installation"},"supported database and versions"),".\n:::"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Strapi ",(0,i.kt)("inlineCode",{parentName:"p"},"v4.6.2")," introduced a new format for the database configuration file that allows all of the database configuration properties to be set using environment variables. Only new projects created after the ",(0,i.kt)("inlineCode",{parentName:"p"},"v4.6.2")," release will include the new configuration, however, earlier projects can utilize the new configuration by manually modifying the ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.js")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.ts")," and updating the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file. See ",(0,i.kt)("a",{parentName:"p",href:"#environment-variables-in-database-configurations"},"environment variables in database configurations"))),(0,i.kt)("h2",{id:"configuration-structure"},"Configuration structure"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.js")," (or ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.ts")," for TypeScript) accepts 2 main configuration objects:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#connection-configuration-object"},(0,i.kt)("inlineCode",{parentName:"a"},"connection"))," for database configuration options passed to ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/knex/knex"},"Knex.js")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#settings-configuration-object"},(0,i.kt)("inlineCode",{parentName:"a"},"settings"))," for Strapi-specific database settings")),(0,i.kt)("h3",{id:"connection-configuration-object"},(0,i.kt)("inlineCode",{parentName:"h3"},"connection")," configuration object"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Default"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"client")),(0,i.kt)("td",{parentName:"tr",align:null},"Database client to create the connection.",(0,i.kt)("br",null),"Accepts the following values:",(0,i.kt)("ul",null,(0,i.kt)("li",null,"For SQLite databases:",(0,i.kt)("ul",null,(0,i.kt)("li",null,(0,i.kt)("inlineCode",{parentName:"td"},"sqlite3")),(0,i.kt)("li",null,(0,i.kt)("inlineCode",{parentName:"td"},"better-sqlite3")))),(0,i.kt)("li",null,"For PostgreSQL databases: ",(0,i.kt)("inlineCode",{parentName:"td"},"postgres")),(0,i.kt)("li",null,"For MySQL databases:",(0,i.kt)("ul",null,(0,i.kt)("li",null,(0,i.kt)("inlineCode",{parentName:"td"},"mysql")),(0,i.kt)("li",null,(0,i.kt)("inlineCode",{parentName:"td"},"mysql2")," (see ",(0,i.kt)("a",{parentName:"td",href:"#alternative-database-driver-packages"},"additional details"),")"))))),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"String")),(0,i.kt)("td",{parentName:"tr",align:null},"-")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"connection")),(0,i.kt)("td",{parentName:"tr",align:null},"Database ",(0,i.kt)("a",{parentName:"td",href:"#connection-parameters"},"connection information")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Object")),(0,i.kt)("td",{parentName:"tr",align:null},"-")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"debug")),(0,i.kt)("td",{parentName:"tr",align:null},"Show database exchanges and errors."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Boolean")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"false"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"useNullAsDefault"),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("em",{parentName:"td"},"Optional, only for SQLite")),(0,i.kt)("td",{parentName:"tr",align:null},"Use ",(0,i.kt)("inlineCode",{parentName:"td"},"NULL")," as a default value"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Boolean")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"true"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"pool"),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("em",{parentName:"td"},"Optional")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#database-pooling-options"},"Database pooling options")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Object")),(0,i.kt)("td",{parentName:"tr",align:null},"-")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"acquireConnectionTimeout"),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("em",{parentName:"td"},"Optional")),(0,i.kt)("td",{parentName:"tr",align:null},"How long knex will wait before throwing a timeout error when acquiring a connection (in milliseconds)"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"60000"))))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"A ",(0,i.kt)("inlineCode",{parentName:"p"},"client")," value of 'sqlite' will be modified by Strapi to be 'better-sqlite3' if the package is available in your project, or 'sqlite3' if it is not.")),(0,i.kt)("h4",{id:"connection-parameters"},"Connection parameters"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"connection.connection")," object found in ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.js")," (or ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.ts")," for TypeScript) is used to pass database connection information and accepts the following parameters:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"connectionString")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#database-connections-using-connectionstring"},"Database connection string"),". When set, it overrides the other ",(0,i.kt)("inlineCode",{parentName:"td"},"connection.connection")," properties. To disable use an empty string: ",(0,i.kt)("inlineCode",{parentName:"td"},"''"),". ",(0,i.kt)("br",null)," ",(0,i.kt)("strong",{parentName:"td"},"Available in Strapi v4.6.2+")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"String"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"host")),(0,i.kt)("td",{parentName:"tr",align:null},"Database host name. Default value: ",(0,i.kt)("inlineCode",{parentName:"td"},"localhost"),"."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"String"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"port")),(0,i.kt)("td",{parentName:"tr",align:null},"Database port"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"database")),(0,i.kt)("td",{parentName:"tr",align:null},"Database name."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"String"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"user")),(0,i.kt)("td",{parentName:"tr",align:null},"Username used to establish the connection"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"String"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"password")),(0,i.kt)("td",{parentName:"tr",align:null},"Password used to establish the connection"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"String"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"timezone")),(0,i.kt)("td",{parentName:"tr",align:null},"Set the default behavior for local time. Default value: ",(0,i.kt)("inlineCode",{parentName:"td"},"utc")," ",(0,i.kt)("a",{parentName:"td",href:"https://www.php.net/manual/en/timezones.php"},"Timezone options")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"String"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"schema")),(0,i.kt)("td",{parentName:"tr",align:null},"Set the default database schema. ",(0,i.kt)("strong",{parentName:"td"},"Used only for Postgres DB.")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"String"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ssl")),(0,i.kt)("td",{parentName:"tr",align:null},"For SSL database connection.",(0,i.kt)("br",null)," Use an object to pass certificate files as strings."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Boolean")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"Object"))))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Depending on the database client used, more parameters can be set (e.g., ",(0,i.kt)("inlineCode",{parentName:"p"},"charset")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"collation")," for ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/mysqljs/mysql#connection-options"},"mysql"),"). Check the database client documentation to know what parameters are available, for instance the ",(0,i.kt)("a",{parentName:"p",href:"https://node-postgres.com/apis/client#new-client"},"pg"),", ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/mysqljs/mysql#connection-options"},"mysql"),", and ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/WiseLibs/better-sqlite3/blob/master/docs/api.md#new-databasepath-options"},"better-sqlite3")," documentations.")),(0,i.kt)("h4",{id:"database-pooling-options"},"Database pooling options"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"connection.pool")," object optionally found in ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.js")," (or ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.ts")," for TypeScript) is used to pass ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/vincit/tarn.js"},"Tarn.js")," database pooling options and accepts the following parameters:"),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"When using Docker, change the pool ",(0,i.kt)("inlineCode",{parentName:"p"},"min")," value to ",(0,i.kt)("inlineCode",{parentName:"p"},"0")," as Docker will kill any idle connections, making it impossible to keep any open connections to the database (see the ",(0,i.kt)("a",{parentName:"p",href:"https://knexjs.org/guide/#pool"},"Tarn.js pool")," settings used by Knex.js for more information).")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Default"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"min")),(0,i.kt)("td",{parentName:"tr",align:null},"Minimum number of database connections to keepalive"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"2"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"max")),(0,i.kt)("td",{parentName:"tr",align:null},"Maximum number of database connections to keepalive"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"10"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"acquireTimeoutMillis")),(0,i.kt)("td",{parentName:"tr",align:null},"Time in milliseconds before timing out a database connection attempt"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"60000"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"createTimeoutMillis")),(0,i.kt)("td",{parentName:"tr",align:null},"Time in milliseconds before timing out a create query attempt"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"30000"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"destroyTimeoutMillis")),(0,i.kt)("td",{parentName:"tr",align:null},"Time in milliseconds before timing out a destroy query attempt"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"5000"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"idleTimeoutMillis")),(0,i.kt)("td",{parentName:"tr",align:null},"Time in milliseconds before free database connections are destroyed"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"30000"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"reapIntervalMillis")),(0,i.kt)("td",{parentName:"tr",align:null},"Time in milliseconds to check for idle database connections to destroy"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"1000"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"createRetryIntervalMillis")),(0,i.kt)("td",{parentName:"tr",align:null},"Time in milliseconds to idle before retrying failed create actions"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Integer")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"200"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"afterCreate")),(0,i.kt)("td",{parentName:"tr",align:null},"Callback function to execute custom logic when the pool acquires a new connection.",(0,i.kt)("br",null),(0,i.kt)("br",null),"See the ",(0,i.kt)("a",{parentName:"td",href:"https://knexjs.org/#Installation-pooling"},"Knex.js documentation")," for more information"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Function")),(0,i.kt)("td",{parentName:"tr",align:null},"-")))),(0,i.kt)("h3",{id:"settings-configuration-object"},(0,i.kt)("inlineCode",{parentName:"h3"},"settings")," configuration object"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"settings")," object found in ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.js")," (or ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.ts")," for TypeScript) is used to configure Strapi-specific database settings and accepts the following parameters:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Default"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"forceMigration")),(0,i.kt)("td",{parentName:"tr",align:null},"Enable or disable the forced database migration."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Boolean")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"true"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"runMigrations")),(0,i.kt)("td",{parentName:"tr",align:null},"Enable or disable database migrations from running on start up."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Boolean")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"true"))))),(0,i.kt)("h3",{id:"configuration-examples"},"Configuration examples"),(0,i.kt)(m,{mdxType:"Tabs"},(0,i.kt)(c,{value:"PostgreSQL",label:"PostgreSQL",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./config/database.js"',title:'"./config/database.js"'},"module.exports = ({ env }) => ({\n  connection: {\n    client: 'postgres',\n    connection: {\n      host: env('DATABASE_HOST', '127.0.0.1'),\n      port: env.int('DATABASE_PORT', 5432),\n      database: env('DATABASE_NAME', 'strapi'),\n      user: env('DATABASE_USERNAME', 'strapi'),\n      password: env('DATABASE_PASSWORD', 'strapi'),\n      schema: env('DATABASE_SCHEMA', 'public'), // Not required\n      ssl: {\n        rejectUnauthorized: env.bool('DATABASE_SSL_SELF', false), // For self-signed certificates\n      },\n    },\n    debug: false,\n  },\n});\n")),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Strapi is aware that there is an issue regarding ",(0,i.kt)("strong",{parentName:"p"},"SSL support for the server"),".\nIn order to fix it, you have to set the ",(0,i.kt)("inlineCode",{parentName:"p"},"ssl:{}")," object as a boolean in order to disable it. See below for example:"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = ({ env }) => ({\n  connection: {\n    client: 'postgres',\n    connection: {\n      ...\n      ssl: env('DATABASE_SSL', false)\n    },\n  },\n});\n"))),(0,i.kt)("p",null,"Please note that if you need client side SSL CA verification you will need to use the ",(0,i.kt)("inlineCode",{parentName:"p"},"ssl:{}")," object with the fs module to convert your CA certificate to a string. You can see an example below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const fs = require('fs');\nmodule.exports = ({ env }) => ({\n  connection: {\n    client: 'postgres',\n    connection: {\n      ...\n      ssl: {\n        ca: fs.readFileSync(`${__dirname}/path/to/your/ca-certificate.crt`).toString(),\n      },\n    },\n  },\n});\n"))),(0,i.kt)(c,{value:"MySQL/MariaDB",label:"MySQL/MariaDB",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./config/database.js"',title:'"./config/database.js"'},"module.exports = ({ env }) => ({\n  connection: {\n    client: 'mysql',\n    connection: {\n      host: env('DATABASE_HOST', '127.0.0.1'),\n      port: env.int('DATABASE_PORT', 3306),\n      database: env('DATABASE_NAME', 'strapi'),\n      user: env('DATABASE_USERNAME', 'strapi'),\n      password: env('DATABASE_PASSWORD', 'strapi'),\n      ssl: {\n        rejectUnauthorized: env.bool('DATABASE_SSL_SELF', false), // For self-signed certificates\n      },\n    },\n    debug: false,\n  },\n});\n"))),(0,i.kt)(c,{value:"SQLite",label:"SQLite",mdxType:"TabItem"},(0,i.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,i.kt)(c,{value:"javascript",label:"JavaScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="./config/database.js"',title:'"./config/database.js"'},"module.exports = ({ env }) => ({\n  connection: {\n    client: 'sqlite',\n    connection: {\n      filename: env('DATABASE_FILENAME', '.tmp/data.db'),\n    },\n    useNullAsDefault: true,\n    debug: false,\n  },\n});\n"))),(0,i.kt)(c,{value:"typescript",label:"TypeScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="./config/database.ts"',title:'"./config/database.ts"'},"import path from 'path';\nexport default ({ env }) => ({\n  connection: {\n    client: 'sqlite',\n    connection: {\n      filename: path.join(\n        __dirname,\n        '..',\n        '..',\n        env('DATABASE_FILENAME', path.join('.tmp', 'data.db'))\n      ),\n    },\n    useNullAsDefault: true,\n  },\n});\n")))))),(0,i.kt)("h2",{id:"configuration-in-database"},"Configuration in database"),(0,i.kt)("p",null,"Configuration files are not multi-server friendly. To update configurations in production you can use a data store to get and set settings."),(0,i.kt)("h3",{id:"get-settings"},"Get settings"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"environment")," (string): Sets the environment you want to store the data in. By default it's current environment (can be an empty string if your configuration is environment agnostic)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"type")," (string): Sets if your configuration is for an ",(0,i.kt)("inlineCode",{parentName:"li"},"api"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"plugin")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"core"),". By default it's ",(0,i.kt)("inlineCode",{parentName:"li"},"core"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name")," (string): You have to set the plugin or api name if ",(0,i.kt)("inlineCode",{parentName:"li"},"type")," is ",(0,i.kt)("inlineCode",{parentName:"li"},"api")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"plugin"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"key")," (string, required): The name of the key you want to store.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// strapi.store(object).get(object);\n// create reusable plugin store variable\nconst pluginStore = strapi.store({\n  environment: strapi.config.environment,\n  type: 'plugin',\n  name: 'users-permissions',\n});\nawait pluginStore.get({ key: 'grant' });\n")),(0,i.kt)("h3",{id:"set-settings"},"Set settings"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"value")," (any, required): The value you want to store.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// strapi.store(object).set(object);\n// create reusable plugin store variable\nconst pluginStore = strapi.store({\n  environment: strapi.config.environment,\n  type: 'plugin',\n  name: 'users-permissions'\n});\nawait pluginStore.set({\n  key: 'grant',\n  value: {\n    ...\n  }\n});\n")),(0,i.kt)("h2",{id:"environment-variables-in-database-configurations"},"Environment variables in database configurations"),(0,i.kt)("p",null,"Strapi version ",(0,i.kt)("inlineCode",{parentName:"p"},"v4.6.2")," and higher includes the database configuration options in the ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.js")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"./config/database.ts")," file. When a new project is created the environment variable ",(0,i.kt)("inlineCode",{parentName:"p"},"DATABASE_CLIENT")," with the value ",(0,i.kt)("inlineCode",{parentName:"p"},"mysql"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"postgres"),", or ",(0,i.kt)("inlineCode",{parentName:"p"},"sqlite")," is automatically added to the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file depending on which database you choose during project creation. Additionally, all of the environment variables necessary to connect to your local development database are also added to the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file.  The following is an example of the generated configuration file:"),(0,i.kt)(m,{groupId:"js-ts",mdxType:"Tabs"},(0,i.kt)(c,{value:"javascript",label:"JavaScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const path = require('path');\n\nmodule.exports = ({ env }) => {\n  const client = env('DATABASE_CLIENT', 'sqlite');\n\n  const connections = {\n    mysql: {\n      connection: {\n        connectionString: env('DATABASE_URL'),\n        host: env('DATABASE_HOST', 'localhost'),\n        port: env.int('DATABASE_PORT', 3306),\n        database: env('DATABASE_NAME', 'strapi'),\n        user: env('DATABASE_USERNAME', 'strapi'),\n        password: env('DATABASE_PASSWORD', 'strapi'),\n        ssl: env.bool('DATABASE_SSL', false) && {\n          key: env('DATABASE_SSL_KEY', undefined),\n          cert: env('DATABASE_SSL_CERT', undefined),\n          ca: env('DATABASE_SSL_CA', undefined),\n          capath: env('DATABASE_SSL_CAPATH', undefined),\n          cipher: env('DATABASE_SSL_CIPHER', undefined),\n          rejectUnauthorized: env.bool(\n            'DATABASE_SSL_REJECT_UNAUTHORIZED',\n            true\n          ),\n        },\n      },\n      pool: { min: env.int('DATABASE_POOL_MIN', 2), max: env.int('DATABASE_POOL_MAX', 10) },\n    },\n    postgres: {\n      connection: {\n        connectionString: env('DATABASE_URL'),\n        host: env('DATABASE_HOST', 'localhost'),\n        port: env.int('DATABASE_PORT', 3306),\n        database: env('DATABASE_NAME', 'strapi'),\n        user: env('DATABASE_USERNAME', 'strapi'),\n        password: env('DATABASE_PASSWORD', 'strapi'),\n        ssl: env.bool('DATABASE_SSL', false) && {\n          key: env('DATABASE_SSL_KEY', undefined),\n          cert: env('DATABASE_SSL_CERT', undefined),\n          ca: env('DATABASE_SSL_CA', undefined),\n          capath: env('DATABASE_SSL_CAPATH', undefined),\n          cipher: env('DATABASE_SSL_CIPHER', undefined),\n          rejectUnauthorized: env.bool(\n            'DATABASE_SSL_REJECT_UNAUTHORIZED',\n            true\n          ),\n        },\n        schema: env('DATABASE_SCHEMA', 'public'),\n      },\n      pool: { min: env.int('DATABASE_POOL_MIN', 2), max: env.int('DATABASE_POOL_MAX', 10) },\n    },\n    sqlite: {\n      connection: {\n        filename: path.join(\n          __dirname,\n          '..',\n          env('DATABASE_FILENAME', 'data.db')\n        ),\n      },\n      useNullAsDefault: true,\n    },\n  };\n\n  return {\n    connection: {\n      client,\n      ...connections[client],\n      acquireConnectionTimeout: env.int('DATABASE_CONNECTION_TIMEOUT', 60000),\n    },\n  };\n};\n"))),(0,i.kt)(c,{value:"typescript",label:"TypeScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import path from 'path';\n\nexport default ({ env }) => {\n  const client = env('DATABASE_CLIENT', 'sqlite');\n\n  const connections = {\n    mysql: {\n      connection: {\n        connectionString: env('DATABASE_URL'),\n        host: env('DATABASE_HOST', 'localhost'),\n        port: env.int('DATABASE_PORT', 3306),\n        database: env('DATABASE_NAME', 'strapi'),\n        user: env('DATABASE_USERNAME', 'strapi'),\n        password: env('DATABASE_PASSWORD', 'strapi'),\n        ssl: env.bool('DATABASE_SSL', false) && {\n          key: env('DATABASE_SSL_KEY', undefined),\n          cert: env('DATABASE_SSL_CERT', undefined),\n          ca: env('DATABASE_SSL_CA', undefined),\n          capath: env('DATABASE_SSL_CAPATH', undefined),\n          cipher: env('DATABASE_SSL_CIPHER', undefined),\n          rejectUnauthorized: env.bool(\n            'DATABASE_SSL_REJECT_UNAUTHORIZED',\n            true\n          ),\n        },\n      },\n      pool: { min: env.int('DATABASE_POOL_MIN', 2), max: env.int('DATABASE_POOL_MAX', 10) },\n    },\n    postgres: {\n      connection: {\n        connectionString: env('DATABASE_URL'),\n        host: env('DATABASE_HOST', 'localhost'),\n        port: env.int('DATABASE_PORT', 3306),\n        database: env('DATABASE_NAME', 'strapi'),\n        user: env('DATABASE_USERNAME', 'strapi'),\n        password: env('DATABASE_PASSWORD', 'strapi'),\n        ssl: env.bool('DATABASE_SSL', false) && {\n          key: env('DATABASE_SSL_KEY', undefined),\n          cert: env('DATABASE_SSL_CERT', undefined),\n          ca: env('DATABASE_SSL_CA', undefined),\n          capath: env('DATABASE_SSL_CAPATH', undefined),\n          cipher: env('DATABASE_SSL_CIPHER', undefined),\n          rejectUnauthorized: env.bool(\n            'DATABASE_SSL_REJECT_UNAUTHORIZED',\n            true\n          ),\n        },\n        schema: env('DATABASE_SCHEMA', 'public'),\n      },\n      pool: { min: env.int('DATABASE_POOL_MIN', 2), max: env.int('DATABASE_POOL_MAX', 10) },\n    },\n    sqlite: {\n      connection: {\n        filename: path.join(\n          __dirname,\n          '..',\n          env('DATABASE_FILENAME', 'data.db')\n        ),\n      },\n      useNullAsDefault: true,\n    },\n  };\n\n  return {\n    connection: {\n      client,\n      ...connections[client],\n      acquireConnectionTimeout: env.int('DATABASE_CONNECTION_TIMEOUT', 60000),\n    },\n  };\n};\n")))),(0,i.kt)("p",null,"The following are examples of the corresponding ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file database-related keys for each of the possible databases:"),(0,i.kt)(m,{mdxType:"Tabs"},(0,i.kt)(c,{value:"mysql",label:"MySQL or MariaDB",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"\n# Database\nDATABASE_CLIENT=mysql\nDATABASE_HOST=127.0.0.1\nDATABASE_PORT=3306\nDATABASE_NAME=strapi\nDATABASE_USERNAME=strapi\nDATABASE_PASSWORD=strap1\nDATABASE_SSL=false\n"))),(0,i.kt)(c,{value:"postgres",label:"PostgreSQL",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"\n# Database\nDATABASE_CLIENT=postgres\nDATABASE_HOST=127.0.0.1\nDATABASE_PORT=5432\nDATABASE_NAME=strapi\nDATABASE_USERNAME=strapi\nDATABASE_PASSWORD=strapi\nDATABASE_SSL=false\n"))),(0,i.kt)(c,{value:"sqlite",label:"SQLite",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"\n# Database\nDATABASE_CLIENT=sqlite\nDATABASE_FILENAME=.tmp/data.db\n")))),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"If you are getting an ",(0,i.kt)("inlineCode",{parentName:"p"},"ER_ACCESS_DENIED_ERROR message")," and the ",(0,i.kt)("inlineCode",{parentName:"p"},"DATABASE_PASSWORD")," value in your ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file includes special characters, try surrounding the password with single quotes. For instance, ",(0,i.kt)("inlineCode",{parentName:"p"},"DATABASE_PASSWORD=example-i-had-special-chars-like-#")," should become ",(0,i.kt)("inlineCode",{parentName:"p"},"DATABASE_PASSWORD='example-i-had-special-chars-like-#'"),".")),(0,i.kt)("h3",{id:"environment-variables-for-strapi-applications-before-v462"},"Environment variables for Strapi applications before ",(0,i.kt)("inlineCode",{parentName:"h3"},"v4.6.2")),(0,i.kt)("p",null,"If you started your project with a version prior to ",(0,i.kt)("inlineCode",{parentName:"p"},"v4.6.2")," you can convert your ",(0,i.kt)("inlineCode",{parentName:"p"},"database.js|database.ts")," configuration file following this procedure:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Update your application to ",(0,i.kt)("inlineCode",{parentName:"li"},"v4.6.2")," or a later version. See the ",(0,i.kt)("a",{parentName:"li",href:"/dev-docs/migration-guides"},"Updates and Migrations")," section for any breaking changes that require specific fixes."),(0,i.kt)("li",{parentName:"ol"},"Replace the contents of your ",(0,i.kt)("inlineCode",{parentName:"li"},"./config/database.js")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"./config/database.ts")," file with the preceding JavaScript or TypeScript code."),(0,i.kt)("li",{parentName:"ol"},"Add the environment variables from the preceding code example to your ",(0,i.kt)("inlineCode",{parentName:"li"},".env")," file."),(0,i.kt)("li",{parentName:"ol"},"(",(0,i.kt)("em",{parentName:"li"},"optional"),") Add additional environment variables such as ",(0,i.kt)("inlineCode",{parentName:"li"},"DATABASE_URL")," and the properties of the ",(0,i.kt)("inlineCode",{parentName:"li"},"ssl")," object."),(0,i.kt)("li",{parentName:"ol"},"Save the changes and restart your application.",(0,i.kt)("admonition",{parentName:"li",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Do not overwrite the environment variables: ",(0,i.kt)("inlineCode",{parentName:"p"},"HOST"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"PORT"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"APP_KEYS"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"API_TOKEN_SALT"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"ADMIN_JWT_SECRET"),".")))),(0,i.kt)("h3",{id:"database-connections-using-connectionstring"},"Database connections using ",(0,i.kt)("inlineCode",{parentName:"h3"},"connectionString")),(0,i.kt)("p",null,"Many managed database solutions use the property ",(0,i.kt)("inlineCode",{parentName:"p"},"connectionString")," to connect a database to an application. Strapi ",(0,i.kt)("inlineCode",{parentName:"p"},"v4.6.2")," and later versions include the ",(0,i.kt)("inlineCode",{parentName:"p"},"connectionString")," property. The ",(0,i.kt)("inlineCode",{parentName:"p"},"connectionString")," is a concatenation of all the database properties in the ",(0,i.kt)("inlineCode",{parentName:"p"},"connection.connection")," object. The ",(0,i.kt)("inlineCode",{parentName:"p"},"connectionString"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"overrides the other ",(0,i.kt)("inlineCode",{parentName:"li"},"connection.connection")," properties such as ",(0,i.kt)("inlineCode",{parentName:"li"},"host")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"port"),","),(0,i.kt)("li",{parentName:"ul"},"can be disabled by setting the property to an empty string: ",(0,i.kt)("inlineCode",{parentName:"li"},"''"),".")),(0,i.kt)("h3",{id:"database-management-by-environment"},"Database management by environment"),(0,i.kt)("p",null,"Development of a Strapi application commonly includes customization in the local development environment with a local development database, such as ",(0,i.kt)("inlineCode",{parentName:"p"},"SQLite"),". When the application is ready for another environment such as production or staging the application is deployed with a different database instance, usually ",(0,i.kt)("inlineCode",{parentName:"p"},"MySQL"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"MariaDB"),", or ",(0,i.kt)("inlineCode",{parentName:"p"},"PostgreSQL"),". Database environment variables allow you to switch the attached database. To switch the database connection:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"set a minimum of the ",(0,i.kt)("inlineCode",{parentName:"li"},"DATABASE_CLIENT")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"DATABASE_URL")," for ",(0,i.kt)("inlineCode",{parentName:"li"},"MySQL"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"MariaDB"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"PostgreSQL"),","),(0,i.kt)("li",{parentName:"ul"},"or set a minimum of ",(0,i.kt)("inlineCode",{parentName:"li"},"DATABASE_CLIENT")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"DATABASE_FILENAME")," for ",(0,i.kt)("inlineCode",{parentName:"li"},"SQLite"),".")),(0,i.kt)("p",null,"For deployed versions of your application the database environment variables should be stored wherever your other secrets are stored. The following table gives examples of where the database environment variables should be stored:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Hosting option"),(0,i.kt)("th",{parentName:"tr",align:null},"environment variable storage"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Virtual private server/virtual machine (e.g. AWS EC2)"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ecosystem.config.js")," or ",(0,i.kt)("inlineCode",{parentName:"td"},".env"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"DigitalOcean App Platform"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Environment Variables")," table")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Heroku"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Config vars")," table")))),(0,i.kt)("h2",{id:"databases-installation-guides"},"Databases installation guides"),(0,i.kt)("p",null,"Strapi gives you the option to choose the most appropriate database for your project. Strapi supports ",(0,i.kt)("strong",{parentName:"p"},"PostgreSQL"),", ",(0,i.kt)("strong",{parentName:"p"},"SQLite"),", ",(0,i.kt)("strong",{parentName:"p"},"MySQL")," and ",(0,i.kt)("strong",{parentName:"p"},"MariaDB"),"."),(0,i.kt)("p",null,"The following documentation covers how to install databases locally:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/dev-docs/configurations/sqlite"},"SQLite installation guide"),","),(0,i.kt)("li",{parentName:"ul"},"PostgreSQL (coming soon),"),(0,i.kt)("li",{parentName:"ul"},"MySQL/MariaDB (coming soon).")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"When connecting Strapi to a PostgreSQL database, the database user requires SCHEMA permissions. While the database admin has this permission by default, a new database user explicitly created for the Strapi application will not. This would result in a 500 error when trying to load the admin console."),(0,i.kt)("p",{parentName:"admonition"},"To create a new PostgreSQL user with the SCHEMA permission, use the following steps."),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"# Create a new database user with a secure password\n$ CREATE USER my_strapi_db_user WITH PASSWORD 'password';\n# Connect to the database as the PostgreSQL admin\n$ \\c my_strapi_db_name admin_user\n# Grant schema privileges to the user\n$ GRANT ALL ON SCHEMA public TO my_strapi_db_user;\n"))),(0,i.kt)("h3",{id:"alternative-database-driver-packages"},"Alternative database driver packages"),(0,i.kt)("p",null,"In addition to ",(0,i.kt)("inlineCode",{parentName:"p"},"client")," values of '",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/pg"},"postgres"),"', 'sqlite', and '",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/mysql"},"mysql"),"', Strapi also allows a ",(0,i.kt)("inlineCode",{parentName:"p"},"client")," value of '",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/mysql2"},"mysql2"),"' for those who install and wish to use that package."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"mysql2")," is required for the ",(0,i.kt)("inlineCode",{parentName:"p"},"caching_sha2_password")," auth method used by default in MySQL v8+. If you receive an ",(0,i.kt)("inlineCode",{parentName:"p"},'"ER_NOT_SUPPORTED_AUTH_MODE"')," error when using the ",(0,i.kt)("inlineCode",{parentName:"p"},"mysql")," driver, try adding the ",(0,i.kt)("inlineCode",{parentName:"p"},"mysql2")," package to your project. You should then remove the deprecated ",(0,i.kt)("inlineCode",{parentName:"p"},"connectionString")," parameter from your connection configuration in favor of the ",(0,i.kt)("inlineCode",{parentName:"p"},"user")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"password")," values.")))}k.isMDXComponent=!0}}]);